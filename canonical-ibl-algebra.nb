(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    122811,       2575]
NotebookOptionsPosition[    119132,       2503]
NotebookOutlinePosition[    119596,       2521]
CellTagsIndexPosition[    119553,       2518]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Canonical IBL algebra on cyclic words ", "Title",
 CellChangeTimes->{{3.889871698353063*^9, 3.889871727717902*^9}, 
   3.889871808053013*^9, {3.889882676037936*^9, 3.889882696180113*^9}, {
   3.8898836305539837`*^9, 3.889883684696047*^9}, {3.889883934696534*^9, 
   3.889883951259879*^9}},
 TextAlignment->Center,ExpressionUUID->"4f4b5762-d0ee-4715-b8bc-9999fcd0012f"],

Cell[TextData[StyleBox["Version 1.0\n(c) 2023 Pavel Hajek ",
 FontSize->14]], "Subtitle",
 CellChangeTimes->{{3.889871846871002*^9, 3.889871876213586*^9}, {
  3.889871906573578*^9, 3.8898719303695803`*^9}},
 TextAlignment->Center,ExpressionUUID->"50c7375b-ac0d-4863-a345-07b74c710ace"],

Cell[CellGroupData[{

Cell["Descritption", "Subsection",
 CellChangeTimes->{{3.898332180384635*^9, 
  3.8983321953109503`*^9}},ExpressionUUID->"62160cb7-878d-46f0-b665-\
a438b109e2a8"],

Cell[TextData[{
 "This notebook implements the",
 StyleBox[" canonical involutive Lie bialgebra (IBL algebra)",
  FontSlant->"Italic"],
 " on the vector space generated by cyclic words whose letters are elements \
of a basis of a graded vector space equipped with a symmetric pairing of \
degree n. If the graded vector space is the de Rham cohomology of a smooth \
simply-connected n-manifold M and the pairing is the integration, then the \
induced IBL structure on Hochschild cohomology of M models the natural \
Chas-Sullivan operations on the homology of the space of strings in M. The \
bracket, resp., cobracket extend naturally to derivatives of orders 2, resp., \
1 of the exterior algebra on cyclic words. Viewing the exterior algebra as \
the symmetric algebra of an odd degree shift, one can formulate a natural BV \
formalism such that deformations of the IBL algebra correspond to actions \
satisfying the quantum master equation (this will be implemented in a future \
release). One such action comes from a version of perturbative Chern-Simons \
theory on M.\n\nSee \
https://p135246.github.io/math/research/2023/04/07/canonical-IBL-algebra.html."
}], "Text",
 CellChangeTimes->{{3.898332206714746*^9, 3.898332215686154*^9}, {
  3.898332273199956*^9, 3.898332676941951*^9}, {3.898332761937932*^9, 
  3.898332799530353*^9}, {3.898332875226387*^9, 3.89833318252052*^9}, {
  3.898333302365954*^9, 3.898333318010902*^9}, {3.89833335029697*^9, 
  3.8983334747705584`*^9}, {3.898393698428809*^9, 3.898394664136713*^9}, {
  3.8983947507177753`*^9, 3.898394806008569*^9}, {3.8983948433865557`*^9, 
  3.8983948818751163`*^9}, {3.898395243938271*^9, 
  3.898395244261373*^9}},ExpressionUUID->"7842283f-24a7-4916-bad2-\
47563444102f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Usage", "Subsection",
 CellChangeTimes->{{3.8898733715049553`*^9, 
  3.889873384727515*^9}},ExpressionUUID->"3c4844a6-7d97-479c-bf7d-\
ba25d57e53d0"],

Cell["\<\
Evaluate \[OpenCurlyDoubleQuote]User Data\[CloseCurlyDoubleQuote] (pre-filled \
with example data) and confirm the automatic evaluation of the \
\[OpenCurlyDoubleQuote]Initialization cell\[CloseCurlyDoubleQuote].\
\>", "ItemNumbered",
 CellChangeTimes->{{3.889873385560153*^9, 3.8898734177884693`*^9}, {
  3.8898734578137693`*^9, 3.889873506015355*^9}, {3.889873570857505*^9, 
  3.8898735835459223`*^9}, {3.889873648823554*^9, 3.8898736792133417`*^9}, {
  3.889873819587619*^9, 3.889873898123816*^9}, {3.8898741181291924`*^9, 
  3.889874122389922*^9}, {3.8898741680855627`*^9, 3.889874171449381*^9}, {
  3.889874295685253*^9, 3.8898743032796*^9}, {3.889874355793399*^9, 
  3.889874363789268*^9}, {3.8898771283481283`*^9, 3.889877148027658*^9}, {
  3.889877186799217*^9, 3.889877228797699*^9}, {3.889877312608975*^9, 
  3.889877339519158*^9}, {3.8898827606402407`*^9, 3.889882761446191*^9}, {
  3.889882908857902*^9, 
  3.889882952366116*^9}},ExpressionUUID->"0cd8b9ae-a863-4daa-a7fc-\
62951c9f33f2"],

Cell["Using the pre-filled data you can play with \
\[OpenCurlyDoubleQuote]Examples\[CloseCurlyDoubleQuote].", "ItemNumbered",
 CellChangeTimes->{{3.889873385560153*^9, 3.8898734177884693`*^9}, {
  3.8898734578137693`*^9, 3.88987347410954*^9}, {3.889873508857554*^9, 
  3.889873526242128*^9}, {3.889873561187537*^9, 3.889873600687488*^9}, {
  3.889873638973599*^9, 3.8898736395176773`*^9}, {3.8898736855590477`*^9, 
  3.889873687633815*^9}, {3.8898738682113323`*^9, 3.889873912363598*^9}, {
  3.889873944925685*^9, 3.88987400197593*^9}, {3.889877059904845*^9, 
  3.889877064759284*^9}, {3.8898771574931726`*^9, 3.889877179004973*^9}, {
  3.889877234195342*^9, 3.889877308805529*^9}, {3.889877350213481*^9, 
  3.889877402099267*^9}, {3.88988287701413*^9, 3.889882892039853*^9}, {
  3.889882969769938*^9, 
  3.889883014465942*^9}},ExpressionUUID->"024b716a-e0b8-4578-817c-\
46016f97520d"],

Cell["\<\
In \[OpenCurlyDoubleQuote]Debugging\[CloseCurlyDoubleQuote] you can run tests \
of relations (like Jacobi identity, coJacobi identity,  Drinfeld identity, \
Involutivity) up to some given length of cyclic words.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.889873385560153*^9, 3.8898734177884693`*^9}, {
  3.8898734578137693`*^9, 3.88987347410954*^9}, {3.889873508857554*^9, 
  3.889873557259655*^9}, {3.8898736086433697`*^9, 3.889873634727643*^9}, {
  3.8898736915217323`*^9, 3.889873753337675*^9}, {3.889874009911454*^9, 
  3.8898740254232407`*^9}, {3.889874279431636*^9, 3.889874388869439*^9}, {
  3.889876874233481*^9, 3.8898770418196907`*^9}, {3.889882770388097*^9, 
  3.889882786158492*^9}, {3.889883006187887*^9, 3.8898831151859922`*^9}, {
  3.8898837307482452`*^9, 
  3.889883731149778*^9}},ExpressionUUID->"68ee11fc-395b-4077-b6e4-\
153db6c82a31"]
}, Open  ]],

Cell[CellGroupData[{

Cell["User data", "Subsection",
 CellChangeTimes->{{3.889873772099854*^9, 3.88987378619178*^9}, {
  3.889877071083359*^9, 
  3.889877091145295*^9}},ExpressionUUID->"ddb3e609-40e6-4be5-a264-\
7677171e533d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"symbols", ",", " ", "pairing", ",", "dimn", ",", "verbose"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symbols", "=", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<x\>\"", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"\"\<y\>\"", "->", "0"}]}], "|>"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"generators", " ", "and", " ", "their", " ", "degrees"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pairing", "=", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}], "->", "1"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<y\>\"", ",", "\"\<x\>\""}], "}"}], "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<x\>\""}], "}"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<y\>\"", ",", "\"\<y\>\""}], "}"}], "->", "0"}]}], 
     "|>"}]}], ";"}], " ", 
  RowBox[{"(*", " ", "pairing", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dimn", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"degree", " ", "of", " ", "the", " ", "pairing"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"verbose", "=", "False"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"display", " ", "intermediate", " ", "steps"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.889457261360577*^9, 3.8894572814332857`*^9}, {
   3.8894573434552383`*^9, 3.889457351250948*^9}, {3.88945740177137*^9, 
   3.8894574149212923`*^9}, {3.889457449659153*^9, 3.889457564068112*^9}, {
   3.889457671826077*^9, 3.88945771172228*^9}, {3.889457791430448*^9, 
   3.889457794210415*^9}, {3.8894579873564653`*^9, 3.889458051388893*^9}, {
   3.8894582983651867`*^9, 3.889458477727953*^9}, 3.889458551145998*^9, {
   3.889458604311798*^9, 3.88945860949154*^9}, {3.889458663585568*^9, 
   3.889458795784006*^9}, {3.889458896042098*^9, 3.889459083410891*^9}, {
   3.889459145574757*^9, 3.8894591606824017`*^9}, {3.889459255033092*^9, 
   3.889459255981735*^9}, {3.889459320164105*^9, 3.88945937301506*^9}, {
   3.889459423909445*^9, 3.8894594508784943`*^9}, {3.889459498331317*^9, 
   3.889459529811244*^9}, {3.889459564276544*^9, 3.889459567095417*^9}, {
   3.889459683692607*^9, 3.889459686914646*^9}, {3.8894597216402683`*^9, 
   3.8894597522341223`*^9}, {3.8894598388782587`*^9, 
   3.8894598932745657`*^9}, {3.88945996845855*^9, 3.889459970372408*^9}, {
   3.889460022728229*^9, 3.8894600240417833`*^9}, {3.889460101770718*^9, 
   3.889460265296165*^9}, {3.889460303867827*^9, 3.8894604270882883`*^9}, {
   3.8894605233100233`*^9, 3.889460660109929*^9}, {3.889461124961203*^9, 
   3.889461236924032*^9}, {3.8894612689064493`*^9, 3.8894612798561153`*^9}, {
   3.889461318390916*^9, 3.889461365806675*^9}, {3.88946144982168*^9, 
   3.889461457999625*^9}, {3.889461546662211*^9, 3.889461712200282*^9}, {
   3.889461848596553*^9, 3.889461865199354*^9}, 3.889461902747562*^9, {
   3.889461978630994*^9, 3.8894620073895407`*^9}, {3.889462057285931*^9, 
   3.8894620617106457`*^9}, {3.889462098714581*^9, 3.889462119328287*^9}, {
   3.8894622589466953`*^9, 3.88946235743496*^9}, {3.889462403786529*^9, 
   3.889462437645281*^9}, {3.8894624824562902`*^9, 3.8894625615058413`*^9}, {
   3.889462668583681*^9, 3.889462673187118*^9}, {3.889462706477248*^9, 
   3.889462722389352*^9}, {3.889462755662662*^9, 3.8894627834387503`*^9}, {
   3.889462855966185*^9, 3.8894630352828836`*^9}, {3.889463554397354*^9, 
   3.8894635845908737`*^9}, {3.889463830884307*^9, 3.8894639695198927`*^9}, {
   3.8894640484539957`*^9, 3.889464059067321*^9}, {3.8894641120308933`*^9, 
   3.8894641951801243`*^9}, {3.8894642358872843`*^9, 3.889464243408984*^9}, {
   3.889464296174011*^9, 3.88946435546387*^9}, {3.8894644123899803`*^9, 
   3.8894645616275663`*^9}, {3.8894646810382233`*^9, 3.889464743683819*^9}, {
   3.88946548160192*^9, 3.889465504019937*^9}, {3.889465550678062*^9, 
   3.889465983368737*^9}, {3.889466023920965*^9, 3.8894661646711082`*^9}, {
   3.889466196489027*^9, 3.889466203967475*^9}, {3.889466287798427*^9, 
   3.889466289388359*^9}, {3.8894665081444683`*^9, 3.889466578659131*^9}, {
   3.889466693412856*^9, 3.889466727248331*^9}, {3.889467127914009*^9, 
   3.889467155735948*^9}, {3.889467250087961*^9, 3.889467250562788*^9}, {
   3.889467303244487*^9, 3.889467331707045*^9}, {3.8894674167039413`*^9, 
   3.88946746707725*^9}, {3.889467644561001*^9, 3.889467648488331*^9}, {
   3.8894677614438753`*^9, 3.889467797439168*^9}, 3.889467975830895*^9, 
   3.8894680310796547`*^9, {3.889468080009696*^9, 3.8894682145044127`*^9}, {
   3.889468287169147*^9, 3.889468618786913*^9}, {3.889468650466196*^9, 
   3.889468702569837*^9}, {3.8894947769859324`*^9, 3.889494777267433*^9}, {
   3.889495156541088*^9, 3.889495229129871*^9}, {3.8894953618840437`*^9, 
   3.8894953697219057`*^9}, {3.889495445266452*^9, 3.8894954638005657`*^9}, {
   3.889495495016673*^9, 3.889495506367951*^9}, {3.889495637424384*^9, 
   3.889495703960285*^9}, {3.88949578203257*^9, 3.889495795570838*^9}, {
   3.8894958836749372`*^9, 3.8894958839371557`*^9}, {3.889504508258919*^9, 
   3.889504607859276*^9}, {3.88950470981257*^9, 3.8895048179328833`*^9}, {
   3.889504972676128*^9, 3.889505007972046*^9}, {3.8895050798449917`*^9, 
   3.889505095773525*^9}, {3.889511877932734*^9, 3.8895119569344063`*^9}, {
   3.889511989365542*^9, 3.889512021543437*^9}, {3.8895125772341347`*^9, 
   3.88951262914546*^9}, {3.889512662080105*^9, 3.8895126631194897`*^9}, {
   3.88951271587908*^9, 3.88951279245618*^9}, {3.889512874906878*^9, 
   3.8895130904456377`*^9}, {3.88951320385074*^9, 3.8895133489138193`*^9}, {
   3.8895133839779997`*^9, 3.8895134299098473`*^9}, {3.8895134623563004`*^9, 
   3.889513472710844*^9}, {3.889513575418116*^9, 3.889513747046194*^9}, {
   3.88951378881041*^9, 3.8895138217793283`*^9}, 3.889514390929591*^9, {
   3.8895144504768543`*^9, 3.889514452741126*^9}, {3.889514510437397*^9, 
   3.889514545848832*^9}, {3.889514617373479*^9, 3.889514911260325*^9}, 
   3.889516248869472*^9, {3.889516362120521*^9, 3.889516423797179*^9}, {
   3.889516480714676*^9, 3.889516497738311*^9}, {3.889516587594089*^9, 
   3.889516680618931*^9}, {3.889516719748045*^9, 3.889516737151503*^9}, {
   3.889516804055509*^9, 3.889516822509617*^9}, {3.889516868267393*^9, 
   3.8895168804679127`*^9}, {3.88951692101961*^9, 3.8895169213051567`*^9}, {
   3.8895170522605553`*^9, 3.8895171430846977`*^9}, {3.8895187066356287`*^9, 
   3.889518706871611*^9}, {3.889518751467866*^9, 3.889518835616602*^9}, {
   3.889518869401873*^9, 3.889518880948392*^9}, {3.8895189128320417`*^9, 
   3.889518983400528*^9}, {3.889519040264359*^9, 3.889519116880732*^9}, {
   3.889519148673662*^9, 3.889519164900344*^9}, {3.889519259985711*^9, 
   3.889519267837881*^9}, {3.889519302104652*^9, 3.8895193504201927`*^9}, {
   3.889519388159328*^9, 3.8895194993255*^9}, {3.889519550149146*^9, 
   3.889519676990922*^9}, {3.889519804519898*^9, 3.889519807344172*^9}, {
   3.889519954671022*^9, 3.889519977417399*^9}, {3.8895200127539053`*^9, 
   3.889520065667961*^9}, {3.889520126663701*^9, 3.889520206384419*^9}, 
   3.88952028138426*^9, {3.889520343201437*^9, 3.889520367986001*^9}, {
   3.889520431041028*^9, 3.889520453490938*^9}, {3.889520502520681*^9, 
   3.889520523840386*^9}, {3.889520562344886*^9, 3.8895206336374903`*^9}, {
   3.889520819977584*^9, 3.889520825329723*^9}, {3.889521057813877*^9, 
   3.88952121989985*^9}, {3.88952149971568*^9, 3.889521791963187*^9}, {
   3.889522078757505*^9, 3.889522142961426*^9}, {3.889522216046116*^9, 
   3.889522260303026*^9}, {3.889522427790927*^9, 3.889522452302887*^9}, {
   3.889522509072176*^9, 3.889522531194749*^9}, {3.889522579104426*^9, 
   3.889522612984249*^9}, {3.8895226650240602`*^9, 3.889522697399384*^9}, {
   3.889522750826274*^9, 3.8895228229294853`*^9}, {3.8895228567455883`*^9, 
   3.889522866688046*^9}, {3.889522910974379*^9, 3.889522914312451*^9}, {
   3.889523049210486*^9, 3.889523058424914*^9}, {3.8895230897930593`*^9, 
   3.8895230926704903`*^9}, {3.88952317544785*^9, 3.889523181832961*^9}, {
   3.8895232336739397`*^9, 3.88952323399373*^9}, {3.889523283506425*^9, 
   3.889523332684331*^9}, {3.8895234003468113`*^9, 3.889523618134757*^9}, {
   3.889523682960857*^9, 3.889523707921835*^9}, {3.88952378944326*^9, 
   3.889523824733034*^9}, {3.889526137497595*^9, 3.889526160534382*^9}, {
   3.889526237266103*^9, 3.8895263073079443`*^9}, {3.889526537170693*^9, 
   3.8895265678844347`*^9}, {3.889526609970914*^9, 3.889526630586935*^9}, {
   3.889526806227099*^9, 3.889526813723269*^9}, {3.8895268510003223`*^9, 
   3.889526884732073*^9}, {3.889527479349185*^9, 3.889527568729748*^9}, {
   3.889527637006579*^9, 3.889527639869483*^9}, {3.8895277193637047`*^9, 
   3.889527722973426*^9}, {3.889527828377041*^9, 3.889527866519051*^9}, {
   3.88952795623223*^9, 3.889527959726686*^9}, {3.889528022518671*^9, 
   3.889528040598777*^9}, {3.8895281935362864`*^9, 3.889528248871316*^9}, {
   3.889528317720498*^9, 3.8895283318793592`*^9}, {3.889528372968451*^9, 
   3.8895283733562098`*^9}, {3.889528521824802*^9, 3.889528606760429*^9}, {
   3.889528807609885*^9, 3.889528863937108*^9}, {3.8895289572189093`*^9, 
   3.8895290403527946`*^9}, {3.889529108874897*^9, 3.889529183722228*^9}, {
   3.889529247364377*^9, 3.8895292657334023`*^9}, {3.88953014913383*^9, 
   3.889530162738287*^9}, {3.8895321374107428`*^9, 3.8895321955010347`*^9}, {
   3.889532953627099*^9, 3.889532980689969*^9}, {3.889533198764141*^9, 
   3.8895332101834517`*^9}, {3.8895332691715393`*^9, 3.889533272601194*^9}, {
   3.889533361532628*^9, 3.889533381611527*^9}, {3.889533473129098*^9, 
   3.889533534838183*^9}, {3.889533613581184*^9, 3.889533717332314*^9}, {
   3.889534050270934*^9, 3.8895340508934317`*^9}, {3.889590512432809*^9, 
   3.889590620326148*^9}, {3.889590679418189*^9, 3.889590695809885*^9}, {
   3.889590752297464*^9, 3.889590816470484*^9}, {3.889590851306237*^9, 
   3.889591162192985*^9}, {3.889591192611175*^9, 3.889591210439333*^9}, {
   3.8895912732280188`*^9, 3.889591301324605*^9}, {3.8895914947334833`*^9, 
   3.889591539980542*^9}, {3.889591578228961*^9, 3.8895915869479*^9}, 
   3.88959200040959*^9, {3.889592041462202*^9, 3.889592071602594*^9}, {
   3.889592365360043*^9, 3.889592370497315*^9}, {3.8895924387010937`*^9, 
   3.8895925736565657`*^9}, {3.889592628385322*^9, 3.889592698726502*^9}, {
   3.889592731873684*^9, 3.889592739611349*^9}, {3.889592799090352*^9, 
   3.889592945545314*^9}, {3.8895929866339808`*^9, 3.8895930074639177`*^9}, {
   3.889593050266368*^9, 3.8895931315114183`*^9}, {3.889593172202633*^9, 
   3.8895934936405354`*^9}, {3.889593548490754*^9, 3.889594097676221*^9}, {
   3.889594190197134*^9, 3.88959421190726*^9}, {3.8895942862695*^9, 
   3.889594287106739*^9}, {3.889594328645726*^9, 3.889594344588676*^9}, {
   3.8895944038589287`*^9, 3.889594406084827*^9}, {3.8895945983362627`*^9, 
   3.8895946375632267`*^9}, {3.889594700080147*^9, 3.889594703606909*^9}, {
   3.889594754743981*^9, 3.889594760878222*^9}, {3.8895947922180443`*^9, 
   3.8895948407121353`*^9}, {3.889594882460512*^9, 3.889594979327264*^9}, {
   3.889595059431509*^9, 3.8895950634000063`*^9}, {3.889595116848358*^9, 
   3.8895951800081177`*^9}, {3.889595248577055*^9, 3.8895952729221*^9}, {
   3.889595392873103*^9, 3.8895958465775013`*^9}, {3.88960142893939*^9, 
   3.889602056849979*^9}, {3.8896020899366302`*^9, 3.889602123226632*^9}, {
   3.889602169243588*^9, 3.889602185701206*^9}, 3.889602217996797*^9, {
   3.889602255034512*^9, 3.889602295753601*^9}, {3.889602354765521*^9, 
   3.889602468339383*^9}, {3.8896024992154818`*^9, 3.889602589405324*^9}, {
   3.8896026477736397`*^9, 3.889602648162825*^9}, {3.889602692140802*^9, 
   3.889602692893738*^9}, {3.889602750254243*^9, 3.889602755652672*^9}, {
   3.889602831895149*^9, 3.889602852628709*^9}, {3.889602888582028*^9, 
   3.889602893956455*^9}, {3.889602977519286*^9, 3.8896030482861853`*^9}, {
   3.889603086528316*^9, 3.889603087149754*^9}, {3.8896031296791687`*^9, 
   3.889603158605707*^9}, {3.889603324176115*^9, 3.889603346438321*^9}, {
   3.889603386056954*^9, 3.889603491189888*^9}, {3.889603521712905*^9, 
   3.88960353327076*^9}, {3.889603706360961*^9, 3.8896037128037453`*^9}, {
   3.889603750159461*^9, 3.889603776670588*^9}, {3.8896038146565523`*^9, 
   3.889603815294754*^9}, {3.889603886204768*^9, 3.88960388728909*^9}, {
   3.8896043796105433`*^9, 3.8896043875467987`*^9}, {3.889604434218622*^9, 
   3.889604593764268*^9}, {3.889604650466833*^9, 3.889604670602734*^9}, 
   3.889604703578331*^9, {3.889604782916479*^9, 3.889604871170348*^9}, {
   3.8896049042634974`*^9, 3.889605111571946*^9}, {3.889605153102088*^9, 
   3.8896051589151497`*^9}, {3.8896051919955482`*^9, 3.889605200251039*^9}, {
   3.889605274756826*^9, 3.889605282275991*^9}, 3.8896054495216627`*^9, {
   3.889605568233694*^9, 3.889605909607419*^9}, {3.8896060643233843`*^9, 
   3.889606064886993*^9}, {3.889607792956278*^9, 3.889607793828038*^9}, {
   3.889607965273129*^9, 3.8896079682622547`*^9}, {3.889608023047234*^9, 
   3.889608025326367*^9}, {3.889608436044517*^9, 3.889608505904063*^9}, {
   3.889608609806357*^9, 3.889608640133486*^9}, 3.889608830905422*^9, {
   3.889608899856022*^9, 3.889608902796339*^9}, {3.889609076625526*^9, 
   3.889609080089327*^9}, {3.8896091921460648`*^9, 3.889609205028129*^9}, {
   3.8896092376066523`*^9, 3.8896092970255623`*^9}, {3.889609327401054*^9, 
   3.889609415289864*^9}, {3.889609503507099*^9, 3.889609506547614*^9}, {
   3.889609537354444*^9, 3.889609642104218*^9}, {3.889609694747036*^9, 
   3.8896097304236717`*^9}, {3.889609768516986*^9, 3.8896098509004393`*^9}, {
   3.8896098823492193`*^9, 3.889609902501286*^9}, {3.889609975696059*^9, 
   3.8896099961100883`*^9}, {3.889610125261047*^9, 3.889610127640613*^9}, {
   3.889610241593854*^9, 3.8896103135451*^9}, {3.889610350293851*^9, 
   3.8896104776692533`*^9}, {3.889610600941818*^9, 3.88961090213616*^9}, {
   3.889611007375808*^9, 3.8896110159194927`*^9}, {3.889611101727826*^9, 
   3.8896111484262037`*^9}, {3.889611193761262*^9, 3.8896112350332527`*^9}, {
   3.889611294225017*^9, 3.889611349333379*^9}, {3.889611578313631*^9, 
   3.889611718961999*^9}, {3.889611748992262*^9, 3.889611754535264*^9}, {
   3.889611789917426*^9, 3.8896118399930887`*^9}, {3.8896120815047894`*^9, 
   3.8896121367066383`*^9}, {3.889612167672985*^9, 3.8896122018897867`*^9}, {
   3.889612242848947*^9, 3.8896122464566383`*^9}, {3.889612337346054*^9, 
   3.88961253154135*^9}, {3.8896125828559847`*^9, 3.889612721871355*^9}, {
   3.889612826078689*^9, 3.889613063613151*^9}, {3.889613099536997*^9, 
   3.889613132295641*^9}, {3.889613165951911*^9, 3.889613285920429*^9}, {
   3.889613319216481*^9, 3.8896133275275507`*^9}, {3.889613373999763*^9, 
   3.889613445104438*^9}, {3.8896134789209642`*^9, 3.8896141094830523`*^9}, {
   3.889614148306018*^9, 3.8896141503225193`*^9}, {3.8896142077384853`*^9, 
   3.889614324534779*^9}, {3.889614408643023*^9, 3.889614444322256*^9}, {
   3.8896145517073593`*^9, 3.8896145818819304`*^9}, {3.889614639970145*^9, 
   3.8896146675171423`*^9}, {3.88961474746854*^9, 3.889614749054872*^9}, {
   3.8896148212636414`*^9, 3.8896148664420643`*^9}, 3.889614939700295*^9, {
   3.889614971124834*^9, 3.889615017162601*^9}, {3.8896151004126368`*^9, 
   3.889615115786161*^9}, {3.889615176014597*^9, 3.889615336225205*^9}, {
   3.889615392446059*^9, 3.8896154232355556`*^9}, {3.889615475710349*^9, 
   3.889615491275524*^9}, {3.889615573860807*^9, 3.889615604123807*^9}, {
   3.889615696784528*^9, 3.8896156987538633`*^9}, {3.8896158097683287`*^9, 
   3.8896158155320797`*^9}, {3.889615858167842*^9, 3.889616067251322*^9}, {
   3.889616135515154*^9, 3.889616173251794*^9}, {3.889616219276058*^9, 
   3.889616247213563*^9}, {3.889616367060137*^9, 3.889616404206436*^9}, {
   3.8896165489066687`*^9, 3.889616593565686*^9}, {3.889616623846992*^9, 
   3.8896166258969917`*^9}, {3.889616693127192*^9, 3.889616714952145*^9}, {
   3.8896167466863327`*^9, 3.8896168022000628`*^9}, {3.889616846437011*^9, 
   3.889616886463726*^9}, {3.889616965849167*^9, 3.889617279168826*^9}, {
   3.889617394681859*^9, 3.8896177553912086`*^9}, {3.889617805544354*^9, 
   3.889618053725272*^9}, {3.889682550333459*^9, 3.889682550743993*^9}, {
   3.889682606241431*^9, 3.889682809075336*^9}, {3.8896831828010607`*^9, 
   3.889683200442258*^9}, {3.889683251022951*^9, 3.8896832515871487`*^9}, {
   3.88968349470865*^9, 3.8896835199370413`*^9}, {3.889683647961138*^9, 
   3.889683691886935*^9}, {3.889683818505168*^9, 3.8896838199990263`*^9}, {
   3.889683870771234*^9, 3.889683918825117*^9}, {3.889684016565222*^9, 
   3.889684023065235*^9}, {3.8896841575307617`*^9, 3.889684173099186*^9}, {
   3.889684223800687*^9, 3.8896842361394*^9}, {3.889684438001213*^9, 
   3.889684493675318*^9}, {3.8896845491068983`*^9, 3.889684586513987*^9}, {
   3.889684654955245*^9, 3.8896846576042023`*^9}, {3.8896848058267727`*^9, 
   3.889684856037986*^9}, {3.8896849169651127`*^9, 3.889684919516438*^9}, {
   3.889685319013996*^9, 3.8896853686864443`*^9}, {3.8896856691652327`*^9, 
   3.889685754255883*^9}, {3.889685801735342*^9, 3.889685933116871*^9}, {
   3.889686010167736*^9, 3.889686015100665*^9}, {3.88968605090829*^9, 
   3.8896860513955717`*^9}, {3.889686103882544*^9, 3.889686112444016*^9}, {
   3.889688503969743*^9, 3.889688510755981*^9}, {3.889688590118235*^9, 
   3.889688593741355*^9}, {3.88968865214611*^9, 3.889688693241868*^9}, {
   3.8896887423220453`*^9, 3.889688779965242*^9}, {3.889689041953918*^9, 
   3.889689048297783*^9}, {3.8896891528415937`*^9, 3.88968917400611*^9}, {
   3.889692378629287*^9, 3.8896924463993464`*^9}, {3.889692496378586*^9, 
   3.889692504090364*^9}, 3.8896932227848673`*^9, {3.889693278560781*^9, 
   3.889693346722999*^9}, {3.88969338826114*^9, 3.889693447976417*^9}, {
   3.889693572109049*^9, 3.889693647582678*^9}, {3.889693734421721*^9, 
   3.8896937551402082`*^9}, {3.889693937156021*^9, 3.889694028666502*^9}, {
   3.8896940669735613`*^9, 3.889694114730481*^9}, {3.889694168026567*^9, 
   3.8896942574340982`*^9}, {3.889694362543166*^9, 3.889694386293912*^9}, {
   3.889694447836787*^9, 3.889694497328458*^9}, {3.889694705455735*^9, 
   3.889694714147138*^9}, {3.889694796345386*^9, 3.889694810262829*^9}, {
   3.889694845607836*^9, 3.889694925369104*^9}, 3.889694968148988*^9, {
   3.889695005648303*^9, 3.889695006688548*^9}, {3.889695039583252*^9, 
   3.889695046429875*^9}, {3.889695192622139*^9, 3.889695197286474*^9}, {
   3.889695236342639*^9, 3.889695303396172*^9}, {3.889695341169873*^9, 
   3.889695342600608*^9}, {3.8896954562337523`*^9, 3.889695457982739*^9}, {
   3.889697133838439*^9, 3.889697301400519*^9}, {3.8896975691178093`*^9, 
   3.889697570906506*^9}, {3.889698306319957*^9, 3.8896983231656513`*^9}, {
   3.8896997298203497`*^9, 3.889699764155602*^9}, {3.889699806394508*^9, 
   3.889699817901948*^9}, {3.8896998890696297`*^9, 3.889699916593895*^9}, {
   3.8896999526812696`*^9, 3.889699953082014*^9}, {3.8897013082702923`*^9, 
   3.8897013095148783`*^9}, {3.889701835076433*^9, 3.889701839624166*^9}, {
   3.889716906803858*^9, 3.889716908013506*^9}, {3.88971728795875*^9, 
   3.8897173598807707`*^9}, {3.889717392379727*^9, 3.889717407693124*^9}, {
   3.889717536054348*^9, 3.889717540506566*^9}, {3.889717613510785*^9, 
   3.8897176174572906`*^9}, {3.8897176907048883`*^9, 3.889717693212624*^9}, {
   3.889727820892641*^9, 3.889727936047069*^9}, {3.889728125269939*^9, 
   3.88972815544978*^9}, {3.889728203308967*^9, 3.8897282125906477`*^9}, {
   3.889728312763481*^9, 3.889728328591023*^9}, {3.889728379345726*^9, 
   3.889728428081819*^9}, {3.889728642882374*^9, 3.889728740458518*^9}, {
   3.889728789311101*^9, 3.88972879381802*^9}, {3.889753083774881*^9, 
   3.88975320150605*^9}, {3.889754593927281*^9, 3.8897546148334837`*^9}, {
   3.88975464625006*^9, 3.8897546573232803`*^9}, {3.88976081119433*^9, 
   3.889760857737796*^9}, {3.8897609092666397`*^9, 3.889760912107036*^9}, {
   3.8897609475781803`*^9, 3.889760999594596*^9}, {3.889761065003224*^9, 
   3.8897611103431273`*^9}, {3.889761486196074*^9, 3.8897615014843903`*^9}, 
   3.8897615494364433`*^9, {3.889761637727277*^9, 3.889761639118003*^9}, {
   3.889761708231439*^9, 3.889761709886985*^9}, {3.8897617437091923`*^9, 
   3.8897617621657457`*^9}, {3.889761804693357*^9, 3.889761832066283*^9}, {
   3.8897620190538473`*^9, 3.889762031421023*^9}, {3.8897620997119827`*^9, 
   3.889762100536368*^9}, {3.889762463583571*^9, 3.889762471097652*^9}, {
   3.889762554112406*^9, 3.889762573553787*^9}, {3.889762624625411*^9, 
   3.889762681270576*^9}, {3.889762715057639*^9, 3.8897627447933073`*^9}, {
   3.889762777312941*^9, 3.8897627814803534`*^9}, {3.889766414822946*^9, 
   3.889766417922085*^9}, {3.889772062841913*^9, 3.889772066157476*^9}, {
   3.889772752650895*^9, 3.889772755441873*^9}, {3.889772819925879*^9, 
   3.88977285535785*^9}, {3.889772893723155*^9, 3.8897729876275177`*^9}, {
   3.889773041171514*^9, 3.8897730424905024`*^9}, {3.889773088154813*^9, 
   3.8897731508747*^9}, {3.889773206181242*^9, 3.889773213791629*^9}, {
   3.889773250163784*^9, 3.8897732575508757`*^9}, {3.8897733175738173`*^9, 
   3.889773318719199*^9}, {3.889776617829235*^9, 3.889776635500332*^9}, {
   3.889777015411689*^9, 3.8897772820874434`*^9}, {3.889779260297538*^9, 
   3.889779331748444*^9}, 3.8897794378902063`*^9, {3.8897794725116863`*^9, 
   3.889779472650785*^9}, 3.88977951787656*^9, {3.889779611340424*^9, 
   3.889779613522311*^9}, {3.889779863661998*^9, 3.8897798661736317`*^9}, {
   3.8897800911812572`*^9, 3.889780189309112*^9}, {3.8897802897413177`*^9, 
   3.889780291620406*^9}, {3.8897803260296*^9, 3.889780332244959*^9}, {
   3.889780453280159*^9, 3.889780470004467*^9}, {3.889780516388872*^9, 
   3.889780528493236*^9}, {3.889780567969303*^9, 3.889780650445343*^9}, {
   3.88978098504381*^9, 3.889781004125334*^9}, {3.8897811128786097`*^9, 
   3.889781116077032*^9}, {3.889781228734461*^9, 3.8897812621017847`*^9}, {
   3.88978131414293*^9, 3.889781418000053*^9}, {3.889781521799428*^9, 
   3.889781599622768*^9}, {3.8897817021010113`*^9, 3.889781787376637*^9}, {
   3.889781825599527*^9, 3.889781832496777*^9}, {3.889781953015916*^9, 
   3.889782016456809*^9}, {3.8897820636764727`*^9, 3.8897821056803007`*^9}, {
   3.889782174083735*^9, 3.8897822168339453`*^9}, {3.889783905271328*^9, 
   3.889783963320424*^9}, {3.8897843028341303`*^9, 3.8897843054194098`*^9}, {
   3.8897844489302683`*^9, 3.889784449895257*^9}, {3.889784484487093*^9, 
   3.889784500018187*^9}, {3.889784549800853*^9, 3.8897846454228888`*^9}, {
   3.889785235044437*^9, 3.889785268520422*^9}, {3.8897853856072903`*^9, 
   3.889785386119488*^9}, {3.889785622014104*^9, 3.8897856316404743`*^9}, {
   3.889785668459689*^9, 3.8897856696974783`*^9}, {3.889785835795596*^9, 
   3.8897858585878363`*^9}, {3.889785958107296*^9, 3.8897859642847557`*^9}, {
   3.889786018253763*^9, 3.8897861691866827`*^9}, {3.889786787194234*^9, 
   3.889786806592795*^9}, {3.88978686562932*^9, 3.88978709766844*^9}, {
   3.8897871295635853`*^9, 3.889787629638638*^9}, {3.889787666885805*^9, 
   3.889787670566902*^9}, {3.8897877124270163`*^9, 3.8897877562013903`*^9}, {
   3.889871695352352*^9, 3.8898716969776487`*^9}, {3.889873793202325*^9, 
   3.88987379471237*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"2308ceb8-2234-4955-aabe-2d51ddd6ec04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.889871796550708*^9, 3.88987179738968*^9}, {
  3.889874029067766*^9, 
  3.8898740393595533`*^9}},ExpressionUUID->"8e7d33c9-497f-4572-87bf-\
aaa23d71cdcf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"bracket", "[", 
   RowBox[{"\"\<x\>\"", ",", "\"\<yyyy\>\""}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"simple", " ", "bracket"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.889874040232161*^9, {3.889874094375855*^9, 3.88987409635915*^9}, {
   3.8898743947521887`*^9, 3.889874409758309*^9}, {3.889874459289913*^9, 
   3.889874463137657*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"46cd41a6-4d77-46b9-87a9-2927980163b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  TagBox[
   FormBox["\<\"yyy\"\>",
    StandardForm],
   Format]}]], "Output",
 CellChangeTimes->{3.889876367000327*^9, 3.88987854422875*^9, 
  3.898394935252865*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"e439446b-f2a4-4d9d-baf9-13971a414b2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cobracket", "[", "\"\<xyyyy\>\"", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"simple", " ", "cobracket"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.889874410630015*^9, 3.889874420433717*^9}, {
   3.8898744557661*^9, 3.889874469262044*^9}, 3.889874503466044*^9},
 CellLabel->
  "In[129]:=",ExpressionUUID->"d947cf07-7cf8-404f-afc5-03d1a93928bd"],

Cell[BoxData[
 RowBox[{"2", " ", 
  TemplateBox[{
    TagBox[
     FormBox["\"y\"", StandardForm], Format], "\"\[Wedge]\"", 
    TagBox[
     FormBox["\"yy\"", StandardForm], Format]},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.8898763686397*^9, 3.8898778156410646`*^9, 
  3.889878544198949*^9, 3.898332723698284*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"7292b4c8-7974-4fd6-bea9-5761bf3055f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"bracket", "[", 
   RowBox[{"\"\<xyyy\>\"", ",", "\"\<xyy\>\"", ",", "\"\<y\>\""}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "bracket", " ", "extended", " ", "over", " ", "the", " ", "wedge", " ", 
    "product"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.889874421166263*^9, 3.889874482114254*^9}, {
  3.889877414347734*^9, 3.889877500078321*^9}, {3.889877801446789*^9, 
  3.8898778043857813`*^9}, {3.889878343560562*^9, 3.889878361457909*^9}},
 CellLabel->
  "In[3797]:=",ExpressionUUID->"b8224d52-cd97-41ec-afc4-7e3fca002af9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TemplateBox[{
     TagBox[
      FormBox["\"xyy\"", StandardForm], Format], "\"\[Wedge]\"", 
     TagBox[
      FormBox["\"yyy\"", StandardForm], Format]},
    "RowDefault"]}], "+", 
  TemplateBox[{
    TagBox[
     FormBox["\"xyyy\"", StandardForm], Format], "\"\[Wedge]\"", 
    TagBox[
     FormBox["\"yy\"", StandardForm], Format]},
   "RowDefault"], "+", 
  TemplateBox[{
    TagBox[
     FormBox["\"xyyyy\"", StandardForm], Format], "\"\[Wedge]\"", 
    TagBox[
     FormBox["\"y\"", StandardForm], Format]},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{
  3.889876370370659*^9, 3.889876554043954*^9, {3.8898774166157*^9, 
   3.8898774636585073`*^9}, {3.88987749810011*^9, 3.889877500383739*^9}, {
   3.889877713730935*^9, 3.889877715267815*^9}, 3.88987781251712*^9, 
   3.8898785441564007`*^9},
 CellLabel->
  "Out[3797]=",ExpressionUUID->"63d7503e-0d19-4dd8-93e1-e26397e6a4e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cobracket", "[", 
   RowBox[{
   "\"\<xyyyy\>\"", ",", "\"\<xyxyxyxx\>\"", ",", "\"\<yyyxxyyyy\>\""}], 
   "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "cobracket", " ", "extended", " ", "over", " ", "the", " ", "wedge", " ", 
    "product"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.889874482925722*^9, 3.889874522884585*^9}, 
   3.889877620160108*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"f41318c3-ccb8-4552-8d27-9b5a590ee78c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   TemplateBox[{
     TagBox[
      FormBox["\"xxxyxyxy\"", StandardForm], Format], "\"\[Wedge]\"", 
     TagBox[
      FormBox["\"xxyyyyyyy\"", StandardForm], Format], "\"\[Wedge]\"", 
     TagBox[
      FormBox["\"y\"", StandardForm], Format], "\"\[Wedge]\"", 
     TagBox[
      FormBox["\"yy\"", StandardForm], Format]},
    "RowDefault"]}], "+", 
  TemplateBox[{
    TagBox[
     FormBox["\"xxy\"", StandardForm], Format], "\"\[Wedge]\"", 
    TagBox[
     FormBox["\"xxy\"", StandardForm], Format], "\"\[Wedge]\"", 
    TagBox[
     FormBox["\"xxyyyyyyy\"", StandardForm], Format], "\"\[Wedge]\"", 
    TagBox[
     FormBox["\"xyyyy\"", StandardForm], Format]},
   "RowDefault"]}]], "Output",
 CellChangeTimes->{3.889876377770083*^9, 3.8898778104215193`*^9, 
  3.889878544119256*^9, 3.898332146740121*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"03237bad-dfde-4685-bcc3-34f45a9326f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"bracket", "[", 
   RowBox[{"wedge", "[", 
    RowBox[{
     RowBox[{"cobracket", "[", "\"\<xyyyyyy\>\"", "]"}], ",", "\"\<x\>\""}], 
    "]"}], "]"}], "//", "Simplify", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "composed", " ", "expression", " ", "using", " ", "the", " ", "wedge", " ",
     "product"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.889874529778356*^9, 3.889874546190468*^9}, {
  3.889874595722019*^9, 3.889874605674241*^9}, {3.889876384557486*^9, 
  3.889876387374344*^9}, {3.889877822400878*^9, 3.8898778874200983`*^9}, {
  3.8898780370067244`*^9, 3.889878043673958*^9}, {3.889878111812674*^9, 
  3.889878130364664*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"1f34151f-a10a-47f2-970d-7189af4f3254"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "6"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     TemplateBox[{
       TagBox[
        FormBox["\"y\"", StandardForm], Format], "\"\[Wedge]\"", 
       TagBox[
        FormBox["\"yyy\"", StandardForm], Format]},
      "RowDefault"]}], "+", 
    TemplateBox[{
      TagBox[
       FormBox["\"yy\"", StandardForm], Format], "\"\[Wedge]\"", 
      TagBox[
       FormBox["\"yy\"", StandardForm], Format]},
     "RowDefault"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.889877851818869*^9, 3.889877887910404*^9}, 
   3.8898780886190157`*^9, 3.889878544042471*^9, 3.898332149684217*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"e58ea005-f95f-420c-8d46-9430f0dfd52b"]
}, Open  ]],

Cell[TextData[{
 "Possible patterns are:",
 StyleBox[" bracket[s1,...,sk], bracket[wedge[...]], cobracket[s1,...,sk], \
cobracket[wedge[...]], bracket[cobracket[...]]", "CodeText"]
}], "Item",
 CellChangeTimes->{{3.889883145253557*^9, 3.8898832237167873`*^9}, {
  3.889883284781905*^9, 3.889883286977826*^9}, {3.8898833835241823`*^9, 
  3.8898834141328163`*^9}},ExpressionUUID->"059f5541-f666-4d59-a339-\
103df872b099"],

Cell[TextData[{
 StyleBox["bracket", "CodeText"],
 StyleBox[" does not allow mixed inputs like ", "Text"],
 StyleBox["bracket[wedge[\[OpenCurlyDoubleQuote]x\[CloseCurlyDoubleQuote],\
\[CloseCurlyDoubleQuote]y\[CloseCurlyDoubleQuote]],\[CloseCurlyDoubleQuote]y\
\[CloseCurlyDoubleQuote]] ", "CodeText"],
 StyleBox["(to be improved in a future release)", "CodeText",
  FontColor->GrayLevel[0]]
}], "Item",
 CellChangeTimes->{{3.889883145253557*^9, 3.889883198630025*^9}, {
  3.889883230819779*^9, 3.8898833328065653`*^9}, {3.8898834723880653`*^9, 
  3.889883477102241*^9}, {3.88988354640033*^9, 3.889883604970146*^9}, {
  3.898394963623746*^9, 3.898394977825683*^9}, {3.898395026938745*^9, 
  3.898395087123826*^9}},ExpressionUUID->"63fcd4bf-171a-4b26-87b2-\
54563be010a6"],

Cell[TextData[{
 StyleBox["However", "CodeText",
  FontColor->GrayLevel[0]],
 StyleBox[", wedge ", "CodeText"],
 StyleBox["allows mixed inputs, so we can instead write ", "Text"],
 StyleBox["wedge[\"x\",bracket[\"x\",\"y\"],wedge[\"xy\",\"y\"]]", 
  "CodeText"]
}], "Item",
 CellChangeTimes->{{3.889883145253557*^9, 3.889883198630025*^9}, {
  3.889883230819779*^9, 3.8898833328065653`*^9}, {3.8898834723880653`*^9, 
  3.889883477102241*^9}, {3.88988354640033*^9, 3.889883604970146*^9}, {
  3.898394963623746*^9, 3.898394977825683*^9}, {3.898395026938745*^9, 
  3.898395069036249*^9}, {3.8983951145153513`*^9, 
  3.898395116247159*^9}},ExpressionUUID->"f116a4a5-bc3b-44de-b88f-\
e24bd967e472"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization cell", "Subsection",
 CellChangeTimes->{{3.889874044100168*^9, 
  3.889874083687578*^9}},ExpressionUUID->"c68e33f2-7907-45c5-8556-\
f07604b7a9f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"===", " ", 
    RowBox[{"Degrees", " ", "and", " ", "word", " ", "length"}], " ", "==="}],
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "cycdegree", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "total", " ", "degree", " ", "of", " ", "a", 
     " ", "cyclic", " ", "word"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycdegree", "[", "\"\<\>\"", "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycdegree", "[", 
      RowBox[{"s_String", " ", "/;", " ", 
       RowBox[{
        RowBox[{"StringLength", "[", "s", "]"}], "==", "1"}]}], "]"}], ":=", 
     " ", 
     RowBox[{"symbols", "[", "s", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"cycdegree", "[", "s_String", "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"cycdegree", "/@", 
       RowBox[{"Characters", "[", "s", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycdegree", "[", 
      RowBox[{"{", 
       RowBox[{"c_Integer", ",", "s_String"}], "}"}], "]"}], ":=", 
     RowBox[{"cycdegree", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycdegree", "[", 
      RowBox[{"cyc", "[", "s_String", "]"}], "]"}], ":=", 
     RowBox[{"cycdegree", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "shiftedcycdegree", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "shifted", " ", "degree", " ", "of", " ", "a",
      " ", "cyclic", " ", "word"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shiftedcycdegree", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cycdegree", "[", "x", "]"}], "+", "dimn", "-", "2"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "cyclength", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "length", " ", "of", " ", "a", " ", "cyclic", 
     " ", "word"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cyclength", "[", "s_String", "]"}], ":=", 
     RowBox[{"StringLength", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"cyclength", "[", 
      RowBox[{"{", 
       RowBox[{"c_Integer", ",", "s_String"}], "}"}], "]"}], ":=", 
     RowBox[{"cyclength", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cyclength", "[", 
      RowBox[{"cyc", "[", "s_String", "]"}], "]"}], ":=", 
     RowBox[{"cyclength", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", "===", "===", "===", "===", 
     RowBox[{"==", 
      RowBox[{"==", 
       RowBox[{"=", 
        RowBox[{"=", 
         RowBox[{"===", "===", "==="}]}]}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", " ", 
     RowBox[{
     "Exterior", " ", "algebra", " ", "on", " ", "cyclic", " ", "words"}], 
     " ", "==="}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"ClearAll", "[", "rotleft", "]"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Rotate", " ", "a", " ", 
     RowBox[{"word", " ", "'"}], 
     RowBox[{"s", "'"}], " ", "to", " ", "the", " ", "left", " ", "by", " ", 
     "1", " ", "keeping", " ", "track", " ", "of", " ", "the", " ", "sign", 
     " ", "in", " ", "the", " ", 
     RowBox[{"variable", " ", "'"}], 
     RowBox[{"c", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rotleft", "[", 
      RowBox[{"{", 
       RowBox[{"c_Integer", ",", "\"\<\>\""}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"c", ",", "\"\<\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rotleft", "[", 
      RowBox[{"{", 
       RowBox[{"c_Integer", ",", "s_String"}], "}"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"parts", "=", 
         RowBox[{"StringTakeDrop", "[", 
          RowBox[{"s", ",", "1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"cycdegree", "[", 
               RowBox[{"parts", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
              RowBox[{"cycdegree", "[", 
               RowBox[{"parts", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], "*", "c"}], 
          ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"Reverse", "[", "parts", "]"}], "]"}]}], "}"}], ")"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"A", " ", "version", " ", "for", " ", "strings", " ", "only"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rotleft", "[", "s_String", "]"}], ":=", 
     RowBox[{"Last", "[", 
      RowBox[{"rotleft", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "s"}], "}"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "cycasymQ", "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{"Checks", " ", "if", " ", "a", " ", "cyclic", " ", 
     RowBox[{"word", " ", "'"}], 
     RowBox[{"s", "'"}], " ", "has", " ", "cyclic", " ", "antisymmetry"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycasymQ", "[", "s_String", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"NestWhile", "[", 
        RowBox[{"rotleft", ",", 
         RowBox[{"rotleft", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=!=", "s"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "==", 
      RowBox[{"-", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "cycsort", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Rotate", " ", "a", " ", "cyclic", " ", "word", " ", "to", " ", "its", 
     " ", "lexicographically", " ", "minimal", " ", "form", " ", "keeping", 
     " ", "track", " ", "of", " ", "the", " ", "sign"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycsort", "[", 
      RowBox[{"{", 
       RowBox[{"c_Integer", ",", "\"\<\>\""}], "}"}], "]"}], ":=", 
     "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycsort", "[", 
      RowBox[{"{", 
       RowBox[{"c_Integer", ",", "s_String"}], "}"}], "]"}], ":=", 
     RowBox[{"First", "[", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"NestList", "[", 
         RowBox[{"rotleft", ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "s"}], "}"}], ",", 
          RowBox[{
           RowBox[{"cyclength", "[", "s", "]"}], "-", "1"}]}], "]"}], ",", 
        "Last"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"A", " ", "version", " ", "for", " ", "strings", " ", "only"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cycsort", "[", "s_String", "]"}], ":=", 
     RowBox[{
      RowBox[{"cycsort", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "s"}], "}"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "cyc", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Wrapper", " ", "for", " ", "cyclic", " ", "words"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cyc", "[", "\"\<\>\"", "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Cyclic", " ", "words", " ", "with", " ", "cyclic", " ", "antisymmetry", 
     " ", "are", " ", "set", " ", "to", " ", "zero"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cyc", "[", 
      RowBox[{"s_String", "?", "cycasymQ"}], "]"}], ":=", "0"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Cyclic", " ", "words", " ", "are", " ", "automatically", " ", 
      "converted", " ", "to", " ", "their", " ", "minimal", " ", "form"}], 
     ",", " ", 
     RowBox[{"possibly", " ", "acquiring", " ", "a", " ", "sign"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cyc", "[", "s_String", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minimal", "=", 
         RowBox[{"cycsort", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "s"}], "}"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"minimal", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"cyc", "[", 
          RowBox[{"minimal", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], " ", "/;", " ", 
        RowBox[{
         RowBox[{"minimal", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=!=", "s"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Displayed", " ", "form", " ", "of", " ", "a", " ", "cyclic", " ", 
     "word"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"cyc", "[", "s_String", "]"}], "]"}], ":=", 
     RowBox[{"Format", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "koszulsign", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Computes", " ", "the", " ", "antisymmetric", " ", "Koszul", " ", "sign",
       " ", "of", " ", "the", " ", "permutation", " ", 
      RowBox[{"of", " ", "'"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "..."}], "}"}], "'"}], " ", "to", " ", 
      "a", " ", "given", " ", 
      RowBox[{"ordering", " ", "'"}], "perm"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a1", ",", "a2", ",", "..."}], "}"}], "'"}], " ", "using", 
       " ", "the", " ", 
       RowBox[{"degrees", " ", "'"}], "deg"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", "d2", ",", "..."}], "}"}], "'"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"koszulsign", "[", 
      RowBox[{"perm_", ",", "deg_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "perm", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "p", ",", "q", ",", "e"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"Range", "[", "len", "]"}]}], ";", "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "auxiliary", " ", "permutation", " ", "that", " ", "starts", " ", 
            "as", " ", "the", " ", "identity", " ", "and", " ", "is", " ", 
            "subsequently", " ", "transformed", " ", "to", " ", "perm"}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"q", "=", 
           RowBox[{"Range", "[", "len", "]"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"q", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "is", " ", "the", " ", 
            "position", " ", "of", " ", "i", " ", "in", " ", "p"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"e", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<=", "len"}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"after", " ", "the", " ", "i"}], "-", 
               RowBox[{"th", " ", "iteration", " ", "we", " ", "have", " ", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "==", 
              RowBox[{
               RowBox[{"perm", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", "for", " ", "all", " ", 
               "j"}], "<=", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", 
                RowBox[{
                 RowBox[{"q", "[", 
                  RowBox[{"[", 
                   RowBox[{"perm", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", 
                 "1"}]}], ",", 
               RowBox[{"j", ">=", "i"}], ",", 
               RowBox[{"j", "--"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                 "shift", " ", "each", " ", "element", " ", "in", " ", "p", 
                  " ", "that", " ", "has", " ", "index", " ", "j"}], ">=", 
                 RowBox[{"i", " ", "and", " ", "lies", " ", "before", " ", 
                  RowBox[{"perm", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "by", " ", "1", " ", 
                  "to", " ", "the", " ", "right"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"e", "+=", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"deg", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "*", 
                   RowBox[{"deg", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"q", "[", 
                  RowBox[{"[", 
                   RowBox[{"p", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "++"}]}]}], 
              " ", 
              RowBox[{"(*", " ", 
               RowBox[{
               "update", " ", "the", " ", "positions", " ", "in", " ", "q"}], 
               " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"perm", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{"[", 
                RowBox[{"perm", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", "i"}], 
             ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", "e"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "wedge", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Wedge", " ", "product", " ", "of", " ", "cyclic", " ", "words"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"a1", ",", "...", ",", 
       RowBox[{
        RowBox[{"wedge", "[", 
         RowBox[{"b1", ",", "..."}], "]"}], "..."}]}], "]"}], " ", "=", " ", 
     RowBox[{"wedge", "[", 
      RowBox[{"a1", ",", "...", ",", "b1", ",", "..."}], "]"}]}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"wedge", ",", "Flat"}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"x___", ",", "0", ",", "y___"}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"x___", ",", "y_Plus", ",", "z___"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"wedge", "[", 
        RowBox[{"x", ",", "#", ",", "z"}], "]"}], "&"}], "/@", "y"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"c_", " ", "*", " ", "y_"}], ",", " ", "z___"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"wedge", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"x___", ",", "y_String", ",", "z___"}], "]"}], ":=", " ", 
     RowBox[{"wedge", "[", 
      RowBox[{"x", ",", 
       RowBox[{"cyc", "[", "y", "]"}], ",", "z"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Wedge", " ", "product", " ", "of", " ", "nonzero", " ", "cyclic", " ", 
     "words", " ", "is", " ", "zero", " ", "if", " ", "and", " ", "only", " ",
      "if", " ", "it", " ", "contains", " ", "one", " ", "cyclic", " ", 
     "word", " ", "with", " ", "even", " ", "degree", " ", "at", " ", "least",
      " ", "two", " ", "times"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"x", ":", "__cyc"}], "]"}], ":=", 
     RowBox[{"0", " ", "/;", "  ", 
      RowBox[{"Not", "[", 
       RowBox[{"DuplicateFreeQ", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{
           RowBox[{"EvenQ", "[", 
            RowBox[{"shiftedcycdegree", "[", "#", "]"}], "]"}], "&"}]}], 
         "]"}], "]"}], "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Wedge", " ", "products", " ", "are", " ", "automatically", " ", "sorted",
      " ", "to", " ", "their", " ", "lexicographically", " ", "minimal", " ", 
     "form"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"wedge", "[", 
      RowBox[{"x", ":", "__cyc"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ord", "=", 
         RowBox[{"OrderingBy", "[", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", "Last"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"koszulsign", "[", 
          RowBox[{"ord", ",", 
           RowBox[{"shiftedcycdegree", "/@", 
            RowBox[{"{", "x", "}"}]}]}], "]"}], "*", 
         RowBox[{"wedge", "@@", 
          RowBox[{
           RowBox[{"{", "x", "}"}], "[", 
           RowBox[{"[", "ord", "]"}], "]"}]}]}], " ", "/;", " ", 
        RowBox[{"ord", "=!=", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "x", "}"}], "]"}], "]"}]}]}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"How", " ", "to", " ", "display", " ", "wedge", " ", "product"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"wedge", "[", "x__", "]"}], "]"}], ":=", 
     RowBox[{"Row", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", "\"\<\[Wedge]\>\""}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "shuffles", "]"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Generates", " ", "all", " ", 
      RowBox[{"(", 
       RowBox[{"p", ",", "q"}], ")"}]}], "-", 
     RowBox[{"shuffle", " ", "permutations"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shuffles", "[", 
      RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rg", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"p", "+", "q"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{"rg", ",", "#"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{"rg", ",", 
          RowBox[{"{", "p", "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", "===", "===", "===", "===", "==="}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", " ", 
     RowBox[{"Internal", " ", "operation"}], " ", "==="}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "intoperation", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "The", " ", "internal", " ", "operation", " ", "that", " ", "takes", " ",
       "two", " ", "strings"}], ",", " ", 
     RowBox[{"pairs", " ", "their", " ", "first", " ", "elements"}], ",", " ", 
     RowBox[{
     "and", " ", "returns", " ", "the", " ", "result", " ", "of", " ", "the", 
      " ", "pairing", " ", "with", " ", "a", " ", "suitable", " ", "sign", 
      " ", "and", " ", "the", " ", "rests", " ", "of", " ", "the", " ", 
      "strings", " ", "is", " ", "at", " ", "heart", " ", "of", " ", "both", 
      " ", "the", " ", "bracket", " ", "and", " ", "cobracket"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"intoperation", "[", 
      RowBox[{"x_String", ",", "y_String"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"cycdegree", "[", "#", "]"}]}], "}"}], ")"}], "&"}], 
           ",", 
           RowBox[{"StringTakeDrop", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", "1"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"l", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"l", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"dimn", "-", "2"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"l", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], "+", 
                RowBox[{"l", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], "+", 
                RowBox[{"l", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
               ")"}]}]}], ")"}]}], "*", 
          RowBox[{"pairing", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"l", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}], 
           "]"}]}], " ", ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", "===", "===", "===", "===", "==="}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", " ", "Bracket", " ", "==="}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "bracket", "]"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"The", " ", "Lie", " ", "bracket"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"x___", ",", "0", ",", "y___"}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"x___", ",", "y_Plus", ",", "z___"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bracket", "[", 
         RowBox[{"x", ",", "#", ",", "z"}], "]"}], "&"}], ",", "y"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"c_", "*", "y_"}], ",", "z___"}], "]"}], ":=", 
     RowBox[{"c", "  ", 
      RowBox[{"bracket", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", 
      RowBox[{"x_String", ",", "y_String"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "res", ",", "tmpx", ",", "tmpy", ",", "intop", 
         ",", "ext"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmpx", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "x"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmpy", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "y"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ext", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"cycdegree", "[", "x", "]"}], "*", 
             RowBox[{"cycdegree", "[", "y", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"dimn", "-", "2"}], ")"}], "*", 
             RowBox[{"cycdegree", "[", "x", "]"}]}]}], ")"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"external", " ", "factor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"cyclength", "[", "x", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "sum", " ", "over", " ", "all", " ", "cyclic", " ", "permutations",
             " ", "of", " ", "the", " ", "first", " ", "word"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "<=", 
              RowBox[{"cyclength", "[", "y", "]"}]}], ",", 
             RowBox[{"j", "++"}], " ", ",", 
             RowBox[{"(*", " ", 
              RowBox[{
              "sum", " ", "over", " ", "all", " ", "cyclic", " ", 
               "permutations", " ", "of", " ", "the", " ", "second", " ", 
               "word"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"intop", "=", 
               RowBox[{"intoperation", "[", 
                RowBox[{
                 RowBox[{"tmpx", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"tmpy", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"internal", " ", "operation"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"res", "+=", 
               RowBox[{
                RowBox[{"tmpx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", 
                RowBox[{"tmpy", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", "ext", "*", 
                RowBox[{"intop", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", 
                RowBox[{"cyc", "[", 
                 RowBox[{"StringJoin", "[", 
                  RowBox[{
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
              " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"multiply", " ", "input"}], ",", " ", "external", ",",
                 " ", 
                RowBox[{"and", " ", "internal", " ", "coefficients"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"verbose", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<## Bracket iteration \>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<,\>\"", "<>", 
                   RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\< ##\>\""}],
                   "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Permuted input: (\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"tmpx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<)\>\"", 
                   "<>", 
                   RowBox[{"tmpx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<, (\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"tmpy", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<)\>\"", 
                   "<>", 
                   RowBox[{"tmpy", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Internal operation: \>\"", "<>", "\"\<(\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"intop", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<)\>\"", 
                   "<>", 
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<|\>\"", "<>", 
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<External coefficient: \>\"", "<>", "\"\<(\>\"", "<>", 
                   RowBox[{"ToString", "[", "ext", "]"}], "<>", "\"\<)\>\""}],
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tmpy", "=", 
               RowBox[{"rotleft", "[", "tmpy", "]"}]}], ";"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "cyclically", " ", "permute", " ", "the", " ", "secod", " ", 
              "word", " ", "with", " ", "sign"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpx", "=", 
            RowBox[{"rotleft", "[", "tmpx", "]"}]}], ";"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "cyclically", " ", "permute", " ", "the", " ", "first", " ", "word",
            " ", "with", " ", "sign"}], " ", "*)"}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "res"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "multiply", " ", "with", " ", "the", " ", "external", " ", "sign"}], 
       " ", "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", "x_wedge", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lx", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"List", "@@", "x"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Plus", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"koszulsign", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"shiftedcycdegree", "/@", "lx"}]}], "]"}], "*", 
            RowBox[{"wedge", "[", 
             RowBox[{
              RowBox[{"bracket", "@@", 
               RowBox[{"lx", "[", 
                RowBox[{"[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
           "&"}], ",", 
          RowBox[{"shuffles", "[", 
           RowBox[{"2", ",", 
            RowBox[{
             RowBox[{"Length", "[", "lx", "]"}], "-", "2"}]}], "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", "x__cyc", "]"}], ":=", 
     RowBox[{"bracket", "[", 
      RowBox[{"wedge", "[", "x", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bracket", "[", "x__String", "]"}], ":=", 
     RowBox[{"bracket", "@@", 
      RowBox[{"cyc", "/@", 
       RowBox[{"{", "x", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", "===", "===", "===", "===", "==="}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"===", " ", "Cobracket", " ", "==="}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "cobracket", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"The", " ", "Lie", " ", "cobracket"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", 
      RowBox[{"x___", ",", "0", ",", "y___"}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", 
      RowBox[{"x___", ",", "y_Plus", ",", "z___"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cobracket", "[", 
         RowBox[{"x", ",", "#", ",", "z"}], "]"}], "&"}], ",", "y"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"c_", "*", "y_"}], ",", "z___"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"cobracket", "[", 
       RowBox[{"x", ",", "y", ",", "x"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", "x_String", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "j", ",", "res", ",", "tmpx", ",", "tmpx1", ",", "tmpx2", 
         ",", "intop", ",", "ext"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmpx", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "x"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"cyclength", "[", "x", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "3"}], ",", 
             RowBox[{"j", "<=", 
              RowBox[{
               RowBox[{"cyclength", "[", "x", "]"}], "-", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"tmpx1", ",", "tmpx2"}], "}"}], "=", 
               RowBox[{"StringTakeDrop", "[", 
                RowBox[{
                 RowBox[{"tmpx", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"j", "-", "1"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"intop", "=", 
               RowBox[{"intoperation", "[", 
                RowBox[{"tmpx1", ",", "tmpx2"}], "]"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"internal", " ", "operation"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"ext", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dimn", "-", "2"}], ")"}], "*", 
                   RowBox[{"cycdegree", "[", 
                    RowBox[{"intop", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"cycdegree", "[", 
                    RowBox[{"intop", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "*", 
                   RowBox[{"cycdegree", "[", 
                    RowBox[{"intop", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ")"}]}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"res", "+=", " ", 
               RowBox[{
                RowBox[{"1", "/", "2"}], "*", 
                RowBox[{"tmpx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", "ext", "*", 
                RowBox[{"intop", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", 
                RowBox[{"wedge", "[", 
                 RowBox[{
                  RowBox[{"cyc", "[", 
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"cyc", "[", 
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}]}], ";", 
              " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"multiply", " ", "input"}], ",", " ", "external", ",",
                 " ", 
                RowBox[{"and", " ", "internal", " ", "coefficients"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"verbose", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<## Cobracket iteration \>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<,\>\"", "<>", 
                   RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\< ##\>\""}],
                   "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Permuted input: (\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"tmpx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<)\>\"", 
                   "<>", 
                   RowBox[{"tmpx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Internal operation: \>\"", "<>", "\"\<(\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"tmpx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                    RowBox[{"intop", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<>", 
                   "\"\<)\>\"", "<>", 
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<|\>\"", "<>", 
                   RowBox[{"intop", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<External coefficient: \>\"", "<>", "\"\<(\>\"", "<>", 
                   RowBox[{"ToString", "[", "ext", "]"}], "<>", "\"\<)\>\""}],
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpx", "=", 
            RowBox[{"rotleft", "[", "tmpx", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", "x__String", "]"}], ":=", 
     RowBox[{"cobracket", "@@", 
      RowBox[{"cyc", "/@", 
       RowBox[{"{", "x", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", "x__cyc", "]"}], ":=", 
     RowBox[{"cobracket", "[", 
      RowBox[{"wedge", "[", "x", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", "x_wedge", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lx", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"List", "@@", "x"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Plus", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"koszulsign", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"shiftedcycdegree", "/@", "lx"}]}], "]"}], "*", 
            RowBox[{"wedge", "[", 
             RowBox[{
              RowBox[{"cobracket", "@@", 
               RowBox[{"lx", "[", 
                RowBox[{"[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
           "&"}], ",", 
          RowBox[{"shuffles", "[", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "lx", "]"}], "-", "1"}]}], "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.889457261360577*^9, 3.8894572814332857`*^9}, {
   3.8894573434552383`*^9, 3.889457351250948*^9}, {3.88945740177137*^9, 
   3.8894574149212923`*^9}, {3.889457449659153*^9, 3.889457564068112*^9}, {
   3.889457671826077*^9, 3.88945771172228*^9}, {3.889457791430448*^9, 
   3.889457794210415*^9}, {3.8894579873564653`*^9, 3.889458051388893*^9}, {
   3.8894582983651867`*^9, 3.889458477727953*^9}, 3.889458551145998*^9, {
   3.889458604311798*^9, 3.88945860949154*^9}, {3.889458663585568*^9, 
   3.889458795784006*^9}, {3.889458896042098*^9, 3.889459083410891*^9}, {
   3.889459145574757*^9, 3.8894591606824017`*^9}, {3.889459255033092*^9, 
   3.889459255981735*^9}, {3.889459320164105*^9, 3.88945937301506*^9}, {
   3.889459423909445*^9, 3.8894594508784943`*^9}, {3.889459498331317*^9, 
   3.889459529811244*^9}, {3.889459564276544*^9, 3.889459567095417*^9}, {
   3.889459683692607*^9, 3.889459686914646*^9}, {3.8894597216402683`*^9, 
   3.8894597522341223`*^9}, {3.8894598388782587`*^9, 
   3.8894598932745657`*^9}, {3.88945996845855*^9, 3.889459970372408*^9}, {
   3.889460022728229*^9, 3.8894600240417833`*^9}, {3.889460101770718*^9, 
   3.889460265296165*^9}, {3.889460303867827*^9, 3.8894604270882883`*^9}, {
   3.8894605233100233`*^9, 3.889460660109929*^9}, {3.889461124961203*^9, 
   3.889461236924032*^9}, {3.8894612689064493`*^9, 3.8894612798561153`*^9}, {
   3.889461318390916*^9, 3.889461365806675*^9}, {3.88946144982168*^9, 
   3.889461457999625*^9}, {3.889461546662211*^9, 3.889461712200282*^9}, {
   3.889461848596553*^9, 3.889461865199354*^9}, 3.889461902747562*^9, {
   3.889461978630994*^9, 3.8894620073895407`*^9}, {3.889462057285931*^9, 
   3.8894620617106457`*^9}, {3.889462098714581*^9, 3.889462119328287*^9}, {
   3.8894622589466953`*^9, 3.88946235743496*^9}, {3.889462403786529*^9, 
   3.889462437645281*^9}, {3.8894624824562902`*^9, 3.8894625615058413`*^9}, {
   3.889462668583681*^9, 3.889462673187118*^9}, {3.889462706477248*^9, 
   3.889462722389352*^9}, {3.889462755662662*^9, 3.8894627834387503`*^9}, {
   3.889462855966185*^9, 3.8894630352828836`*^9}, {3.889463554397354*^9, 
   3.8894635845908737`*^9}, {3.889463830884307*^9, 3.8894639695198927`*^9}, {
   3.8894640484539957`*^9, 3.889464059067321*^9}, {3.8894641120308933`*^9, 
   3.8894641951801243`*^9}, {3.8894642358872843`*^9, 3.889464243408984*^9}, {
   3.889464296174011*^9, 3.88946435546387*^9}, {3.8894644123899803`*^9, 
   3.8894645616275663`*^9}, {3.8894646810382233`*^9, 3.889464743683819*^9}, {
   3.88946548160192*^9, 3.889465504019937*^9}, {3.889465550678062*^9, 
   3.889465983368737*^9}, {3.889466023920965*^9, 3.8894661646711082`*^9}, {
   3.889466196489027*^9, 3.889466203967475*^9}, {3.889466287798427*^9, 
   3.889466289388359*^9}, {3.8894665081444683`*^9, 3.889466578659131*^9}, {
   3.889466693412856*^9, 3.889466727248331*^9}, {3.889467127914009*^9, 
   3.889467155735948*^9}, {3.889467250087961*^9, 3.889467250562788*^9}, {
   3.889467303244487*^9, 3.889467331707045*^9}, {3.8894674167039413`*^9, 
   3.88946746707725*^9}, {3.889467644561001*^9, 3.889467648488331*^9}, {
   3.8894677614438753`*^9, 3.889467797439168*^9}, 3.889467975830895*^9, 
   3.8894680310796547`*^9, {3.889468080009696*^9, 3.8894682145044127`*^9}, {
   3.889468287169147*^9, 3.889468618786913*^9}, {3.889468650466196*^9, 
   3.889468702569837*^9}, {3.8894947769859324`*^9, 3.889494777267433*^9}, {
   3.889495156541088*^9, 3.889495229129871*^9}, {3.8894953618840437`*^9, 
   3.8894953697219057`*^9}, {3.889495445266452*^9, 3.8894954638005657`*^9}, {
   3.889495495016673*^9, 3.889495506367951*^9}, {3.889495637424384*^9, 
   3.889495703960285*^9}, {3.88949578203257*^9, 3.889495795570838*^9}, {
   3.8894958836749372`*^9, 3.8894958839371557`*^9}, {3.889504508258919*^9, 
   3.889504607859276*^9}, {3.88950470981257*^9, 3.8895048179328833`*^9}, {
   3.889504972676128*^9, 3.889505007972046*^9}, {3.8895050798449917`*^9, 
   3.889505095773525*^9}, {3.889511877932734*^9, 3.8895119569344063`*^9}, {
   3.889511989365542*^9, 3.889512021543437*^9}, {3.8895125772341347`*^9, 
   3.88951262914546*^9}, {3.889512662080105*^9, 3.8895126631194897`*^9}, {
   3.88951271587908*^9, 3.88951279245618*^9}, {3.889512874906878*^9, 
   3.8895130904456377`*^9}, {3.88951320385074*^9, 3.8895133489138193`*^9}, {
   3.8895133839779997`*^9, 3.8895134299098473`*^9}, {3.8895134623563004`*^9, 
   3.889513472710844*^9}, {3.889513575418116*^9, 3.889513747046194*^9}, {
   3.88951378881041*^9, 3.8895138217793283`*^9}, 3.889514390929591*^9, {
   3.8895144504768543`*^9, 3.889514452741126*^9}, {3.889514510437397*^9, 
   3.889514545848832*^9}, {3.889514617373479*^9, 3.889514911260325*^9}, 
   3.889516248869472*^9, {3.889516362120521*^9, 3.889516423797179*^9}, {
   3.889516480714676*^9, 3.889516497738311*^9}, {3.889516587594089*^9, 
   3.889516680618931*^9}, {3.889516719748045*^9, 3.889516737151503*^9}, {
   3.889516804055509*^9, 3.889516822509617*^9}, {3.889516868267393*^9, 
   3.8895168804679127`*^9}, {3.88951692101961*^9, 3.8895169213051567`*^9}, {
   3.8895170522605553`*^9, 3.8895171430846977`*^9}, {3.8895187066356287`*^9, 
   3.889518706871611*^9}, {3.889518751467866*^9, 3.889518835616602*^9}, {
   3.889518869401873*^9, 3.889518880948392*^9}, {3.8895189128320417`*^9, 
   3.889518983400528*^9}, {3.889519040264359*^9, 3.889519116880732*^9}, {
   3.889519148673662*^9, 3.889519164900344*^9}, {3.889519259985711*^9, 
   3.889519267837881*^9}, {3.889519302104652*^9, 3.8895193504201927`*^9}, {
   3.889519388159328*^9, 3.8895194993255*^9}, {3.889519550149146*^9, 
   3.889519676990922*^9}, {3.889519804519898*^9, 3.889519807344172*^9}, {
   3.889519954671022*^9, 3.889519977417399*^9}, {3.8895200127539053`*^9, 
   3.889520065667961*^9}, {3.889520126663701*^9, 3.889520206384419*^9}, 
   3.88952028138426*^9, {3.889520343201437*^9, 3.889520367986001*^9}, {
   3.889520431041028*^9, 3.889520453490938*^9}, {3.889520502520681*^9, 
   3.889520523840386*^9}, {3.889520562344886*^9, 3.8895206336374903`*^9}, {
   3.889520819977584*^9, 3.889520825329723*^9}, {3.889521057813877*^9, 
   3.88952121989985*^9}, {3.88952149971568*^9, 3.889521791963187*^9}, {
   3.889522078757505*^9, 3.889522142961426*^9}, {3.889522216046116*^9, 
   3.889522260303026*^9}, {3.889522427790927*^9, 3.889522452302887*^9}, {
   3.889522509072176*^9, 3.889522531194749*^9}, {3.889522579104426*^9, 
   3.889522612984249*^9}, {3.8895226650240602`*^9, 3.889522697399384*^9}, {
   3.889522750826274*^9, 3.8895228229294853`*^9}, {3.8895228567455883`*^9, 
   3.889522866688046*^9}, {3.889522910974379*^9, 3.889522914312451*^9}, {
   3.889523049210486*^9, 3.889523058424914*^9}, {3.8895230897930593`*^9, 
   3.8895230926704903`*^9}, {3.88952317544785*^9, 3.889523181832961*^9}, {
   3.8895232336739397`*^9, 3.88952323399373*^9}, {3.889523283506425*^9, 
   3.889523332684331*^9}, {3.8895234003468113`*^9, 3.889523618134757*^9}, {
   3.889523682960857*^9, 3.889523707921835*^9}, {3.88952378944326*^9, 
   3.889523824733034*^9}, {3.889526137497595*^9, 3.889526160534382*^9}, {
   3.889526237266103*^9, 3.8895263073079443`*^9}, {3.889526537170693*^9, 
   3.8895265678844347`*^9}, {3.889526609970914*^9, 3.889526630586935*^9}, {
   3.889526806227099*^9, 3.889526813723269*^9}, {3.8895268510003223`*^9, 
   3.889526884732073*^9}, {3.889527479349185*^9, 3.889527568729748*^9}, {
   3.889527637006579*^9, 3.889527639869483*^9}, {3.8895277193637047`*^9, 
   3.889527722973426*^9}, {3.889527828377041*^9, 3.889527866519051*^9}, {
   3.88952795623223*^9, 3.889527959726686*^9}, {3.889528022518671*^9, 
   3.889528040598777*^9}, {3.8895281935362864`*^9, 3.889528248871316*^9}, {
   3.889528317720498*^9, 3.8895283318793592`*^9}, {3.889528372968451*^9, 
   3.8895283733562098`*^9}, {3.889528521824802*^9, 3.889528606760429*^9}, {
   3.889528807609885*^9, 3.889528863937108*^9}, {3.8895289572189093`*^9, 
   3.8895290403527946`*^9}, {3.889529108874897*^9, 3.889529183722228*^9}, {
   3.889529247364377*^9, 3.8895292657334023`*^9}, {3.88953014913383*^9, 
   3.889530162738287*^9}, {3.8895321374107428`*^9, 3.8895321955010347`*^9}, {
   3.889532953627099*^9, 3.889532980689969*^9}, {3.889533198764141*^9, 
   3.8895332101834517`*^9}, {3.8895332691715393`*^9, 3.889533272601194*^9}, {
   3.889533361532628*^9, 3.889533381611527*^9}, {3.889533473129098*^9, 
   3.889533534838183*^9}, {3.889533613581184*^9, 3.889533717332314*^9}, {
   3.889534050270934*^9, 3.8895340508934317`*^9}, {3.889590512432809*^9, 
   3.889590620326148*^9}, {3.889590679418189*^9, 3.889590695809885*^9}, {
   3.889590752297464*^9, 3.889590816470484*^9}, {3.889590851306237*^9, 
   3.889591162192985*^9}, {3.889591192611175*^9, 3.889591210439333*^9}, {
   3.8895912732280188`*^9, 3.889591301324605*^9}, {3.8895914947334833`*^9, 
   3.889591539980542*^9}, {3.889591578228961*^9, 3.8895915869479*^9}, 
   3.88959200040959*^9, {3.889592041462202*^9, 3.889592071602594*^9}, {
   3.889592365360043*^9, 3.889592370497315*^9}, {3.8895924387010937`*^9, 
   3.8895925736565657`*^9}, {3.889592628385322*^9, 3.889592698726502*^9}, {
   3.889592731873684*^9, 3.889592739611349*^9}, {3.889592799090352*^9, 
   3.889592945545314*^9}, {3.8895929866339808`*^9, 3.8895930074639177`*^9}, {
   3.889593050266368*^9, 3.8895931315114183`*^9}, {3.889593172202633*^9, 
   3.8895934936405354`*^9}, {3.889593548490754*^9, 3.889594097676221*^9}, {
   3.889594190197134*^9, 3.88959421190726*^9}, {3.8895942862695*^9, 
   3.889594287106739*^9}, {3.889594328645726*^9, 3.889594344588676*^9}, {
   3.8895944038589287`*^9, 3.889594406084827*^9}, {3.8895945983362627`*^9, 
   3.8895946375632267`*^9}, {3.889594700080147*^9, 3.889594703606909*^9}, {
   3.889594754743981*^9, 3.889594760878222*^9}, {3.8895947922180443`*^9, 
   3.8895948407121353`*^9}, {3.889594882460512*^9, 3.889594979327264*^9}, {
   3.889595059431509*^9, 3.8895950634000063`*^9}, {3.889595116848358*^9, 
   3.8895951800081177`*^9}, {3.889595248577055*^9, 3.8895952729221*^9}, {
   3.889595392873103*^9, 3.8895958465775013`*^9}, {3.88960142893939*^9, 
   3.889602056849979*^9}, {3.8896020899366302`*^9, 3.889602123226632*^9}, {
   3.889602169243588*^9, 3.889602185701206*^9}, 3.889602217996797*^9, {
   3.889602255034512*^9, 3.889602295753601*^9}, {3.889602354765521*^9, 
   3.889602468339383*^9}, {3.8896024992154818`*^9, 3.889602589405324*^9}, {
   3.8896026477736397`*^9, 3.889602648162825*^9}, {3.889602692140802*^9, 
   3.889602692893738*^9}, {3.889602750254243*^9, 3.889602755652672*^9}, {
   3.889602831895149*^9, 3.889602852628709*^9}, {3.889602888582028*^9, 
   3.889602893956455*^9}, {3.889602977519286*^9, 3.8896030482861853`*^9}, {
   3.889603086528316*^9, 3.889603087149754*^9}, {3.8896031296791687`*^9, 
   3.889603158605707*^9}, {3.889603324176115*^9, 3.889603346438321*^9}, {
   3.889603386056954*^9, 3.889603491189888*^9}, {3.889603521712905*^9, 
   3.88960353327076*^9}, {3.889603706360961*^9, 3.8896037128037453`*^9}, {
   3.889603750159461*^9, 3.889603776670588*^9}, {3.8896038146565523`*^9, 
   3.889603815294754*^9}, {3.889603886204768*^9, 3.88960388728909*^9}, {
   3.8896043796105433`*^9, 3.8896043875467987`*^9}, {3.889604434218622*^9, 
   3.889604593764268*^9}, {3.889604650466833*^9, 3.889604670602734*^9}, 
   3.889604703578331*^9, {3.889604782916479*^9, 3.889604871170348*^9}, {
   3.8896049042634974`*^9, 3.889605111571946*^9}, {3.889605153102088*^9, 
   3.8896051589151497`*^9}, {3.8896051919955482`*^9, 3.889605200251039*^9}, {
   3.889605274756826*^9, 3.889605282275991*^9}, 3.8896054495216627`*^9, {
   3.889605568233694*^9, 3.889605909607419*^9}, {3.8896060643233843`*^9, 
   3.889606064886993*^9}, {3.889607792956278*^9, 3.889607793828038*^9}, {
   3.889607965273129*^9, 3.8896079682622547`*^9}, {3.889608023047234*^9, 
   3.889608025326367*^9}, {3.889608436044517*^9, 3.889608505904063*^9}, {
   3.889608609806357*^9, 3.889608640133486*^9}, 3.889608830905422*^9, {
   3.889608899856022*^9, 3.889608902796339*^9}, {3.889609076625526*^9, 
   3.889609080089327*^9}, {3.8896091921460648`*^9, 3.889609205028129*^9}, {
   3.8896092376066523`*^9, 3.8896092970255623`*^9}, {3.889609327401054*^9, 
   3.889609415289864*^9}, {3.889609503507099*^9, 3.889609506547614*^9}, {
   3.889609537354444*^9, 3.889609642104218*^9}, {3.889609694747036*^9, 
   3.8896097304236717`*^9}, {3.889609768516986*^9, 3.8896098509004393`*^9}, {
   3.8896098823492193`*^9, 3.889609902501286*^9}, {3.889609975696059*^9, 
   3.8896099961100883`*^9}, {3.889610125261047*^9, 3.889610127640613*^9}, {
   3.889610241593854*^9, 3.8896103135451*^9}, {3.889610350293851*^9, 
   3.8896104776692533`*^9}, {3.889610600941818*^9, 3.88961090213616*^9}, {
   3.889611007375808*^9, 3.8896110159194927`*^9}, {3.889611101727826*^9, 
   3.8896111484262037`*^9}, {3.889611193761262*^9, 3.8896112350332527`*^9}, {
   3.889611294225017*^9, 3.889611349333379*^9}, {3.889611578313631*^9, 
   3.889611718961999*^9}, {3.889611748992262*^9, 3.889611754535264*^9}, {
   3.889611789917426*^9, 3.8896118399930887`*^9}, {3.8896120815047894`*^9, 
   3.8896121367066383`*^9}, {3.889612167672985*^9, 3.8896122018897867`*^9}, {
   3.889612242848947*^9, 3.8896122464566383`*^9}, {3.889612337346054*^9, 
   3.88961253154135*^9}, {3.8896125828559847`*^9, 3.889612721871355*^9}, {
   3.889612826078689*^9, 3.889613063613151*^9}, {3.889613099536997*^9, 
   3.889613132295641*^9}, {3.889613165951911*^9, 3.889613285920429*^9}, {
   3.889613319216481*^9, 3.8896133275275507`*^9}, {3.889613373999763*^9, 
   3.889613445104438*^9}, {3.8896134789209642`*^9, 3.8896141094830523`*^9}, {
   3.889614148306018*^9, 3.8896141503225193`*^9}, {3.8896142077384853`*^9, 
   3.889614324534779*^9}, {3.889614408643023*^9, 3.889614444322256*^9}, {
   3.8896145517073593`*^9, 3.8896145818819304`*^9}, {3.889614639970145*^9, 
   3.8896146675171423`*^9}, {3.88961474746854*^9, 3.889614749054872*^9}, {
   3.8896148212636414`*^9, 3.8896148664420643`*^9}, 3.889614939700295*^9, {
   3.889614971124834*^9, 3.889615017162601*^9}, {3.8896151004126368`*^9, 
   3.889615115786161*^9}, {3.889615176014597*^9, 3.889615336225205*^9}, {
   3.889615392446059*^9, 3.8896154232355556`*^9}, {3.889615475710349*^9, 
   3.889615491275524*^9}, {3.889615573860807*^9, 3.889615604123807*^9}, {
   3.889615696784528*^9, 3.8896156987538633`*^9}, {3.8896158097683287`*^9, 
   3.8896158155320797`*^9}, {3.889615858167842*^9, 3.889616067251322*^9}, {
   3.889616135515154*^9, 3.889616173251794*^9}, {3.889616219276058*^9, 
   3.889616247213563*^9}, {3.889616367060137*^9, 3.889616404206436*^9}, {
   3.8896165489066687`*^9, 3.889616593565686*^9}, {3.889616623846992*^9, 
   3.8896166258969917`*^9}, {3.889616693127192*^9, 3.889616714952145*^9}, {
   3.8896167466863327`*^9, 3.8896168022000628`*^9}, {3.889616846437011*^9, 
   3.889616886463726*^9}, {3.889616965849167*^9, 3.889617279168826*^9}, {
   3.889617394681859*^9, 3.8896177553912086`*^9}, {3.889617805544354*^9, 
   3.889618053725272*^9}, {3.889682550333459*^9, 3.889682550743993*^9}, {
   3.889682606241431*^9, 3.889682809075336*^9}, {3.8896831828010607`*^9, 
   3.889683200442258*^9}, {3.889683251022951*^9, 3.8896832515871487`*^9}, {
   3.88968349470865*^9, 3.8896835199370413`*^9}, {3.889683647961138*^9, 
   3.889683691886935*^9}, {3.889683818505168*^9, 3.8896838199990263`*^9}, {
   3.889683870771234*^9, 3.889683918825117*^9}, {3.889684016565222*^9, 
   3.889684023065235*^9}, {3.8896841575307617`*^9, 3.889684173099186*^9}, {
   3.889684223800687*^9, 3.8896842361394*^9}, {3.889684438001213*^9, 
   3.889684493675318*^9}, {3.8896845491068983`*^9, 3.889684586513987*^9}, {
   3.889684654955245*^9, 3.8896846576042023`*^9}, {3.8896848058267727`*^9, 
   3.889684856037986*^9}, {3.8896849169651127`*^9, 3.889684919516438*^9}, {
   3.889685319013996*^9, 3.8896853686864443`*^9}, {3.8896856691652327`*^9, 
   3.889685754255883*^9}, {3.889685801735342*^9, 3.889685933116871*^9}, {
   3.889686010167736*^9, 3.889686015100665*^9}, {3.88968605090829*^9, 
   3.8896860513955717`*^9}, {3.889686103882544*^9, 3.889686112444016*^9}, {
   3.889688503969743*^9, 3.889688510755981*^9}, {3.889688590118235*^9, 
   3.889688593741355*^9}, {3.88968865214611*^9, 3.889688693241868*^9}, {
   3.8896887423220453`*^9, 3.889688779965242*^9}, {3.889689041953918*^9, 
   3.889689048297783*^9}, {3.8896891528415937`*^9, 3.88968917400611*^9}, {
   3.889692378629287*^9, 3.8896924463993464`*^9}, {3.889692496378586*^9, 
   3.889692504090364*^9}, 3.8896932227848673`*^9, {3.889693278560781*^9, 
   3.889693346722999*^9}, {3.88969338826114*^9, 3.889693447976417*^9}, {
   3.889693572109049*^9, 3.889693647582678*^9}, {3.889693734421721*^9, 
   3.8896937551402082`*^9}, {3.889693937156021*^9, 3.889694028666502*^9}, {
   3.8896940669735613`*^9, 3.889694114730481*^9}, {3.889694168026567*^9, 
   3.8896942574340982`*^9}, {3.889694362543166*^9, 3.889694386293912*^9}, {
   3.889694447836787*^9, 3.889694497328458*^9}, {3.889694705455735*^9, 
   3.889694714147138*^9}, {3.889694796345386*^9, 3.889694810262829*^9}, {
   3.889694845607836*^9, 3.889694925369104*^9}, 3.889694968148988*^9, {
   3.889695005648303*^9, 3.889695006688548*^9}, {3.889695039583252*^9, 
   3.889695046429875*^9}, {3.889695192622139*^9, 3.889695197286474*^9}, {
   3.889695236342639*^9, 3.889695303396172*^9}, {3.889695341169873*^9, 
   3.889695342600608*^9}, {3.8896954562337523`*^9, 3.889695457982739*^9}, {
   3.889697133838439*^9, 3.889697301400519*^9}, {3.8896975691178093`*^9, 
   3.889697570906506*^9}, {3.889698306319957*^9, 3.8896983231656513`*^9}, {
   3.8896997298203497`*^9, 3.889699764155602*^9}, {3.889699806394508*^9, 
   3.889699817901948*^9}, {3.8896998890696297`*^9, 3.889699916593895*^9}, {
   3.8896999526812696`*^9, 3.889699953082014*^9}, {3.8897013082702923`*^9, 
   3.8897013095148783`*^9}, {3.889701835076433*^9, 3.889701839624166*^9}, {
   3.889716906803858*^9, 3.889716908013506*^9}, {3.88971728795875*^9, 
   3.8897173598807707`*^9}, {3.889717392379727*^9, 3.889717407693124*^9}, {
   3.889717536054348*^9, 3.889717540506566*^9}, {3.889717613510785*^9, 
   3.8897176174572906`*^9}, {3.8897176907048883`*^9, 3.889717693212624*^9}, {
   3.889727820892641*^9, 3.889727936047069*^9}, {3.889728125269939*^9, 
   3.88972815544978*^9}, {3.889728203308967*^9, 3.8897282125906477`*^9}, {
   3.889728312763481*^9, 3.889728328591023*^9}, {3.889728379345726*^9, 
   3.889728428081819*^9}, {3.889728642882374*^9, 3.889728740458518*^9}, {
   3.889728789311101*^9, 3.88972879381802*^9}, {3.889753083774881*^9, 
   3.88975320150605*^9}, {3.889754593927281*^9, 3.8897546148334837`*^9}, {
   3.88975464625006*^9, 3.8897546573232803`*^9}, {3.88976081119433*^9, 
   3.889760857737796*^9}, {3.8897609092666397`*^9, 3.889760912107036*^9}, {
   3.8897609475781803`*^9, 3.889760999594596*^9}, {3.889761065003224*^9, 
   3.8897611103431273`*^9}, {3.889761486196074*^9, 3.8897615014843903`*^9}, 
   3.8897615494364433`*^9, {3.889761637727277*^9, 3.889761639118003*^9}, {
   3.889761708231439*^9, 3.889761709886985*^9}, {3.8897617437091923`*^9, 
   3.8897617621657457`*^9}, {3.889761804693357*^9, 3.889761832066283*^9}, {
   3.8897620190538473`*^9, 3.889762031421023*^9}, {3.8897620997119827`*^9, 
   3.889762100536368*^9}, {3.889762463583571*^9, 3.889762471097652*^9}, {
   3.889762554112406*^9, 3.889762573553787*^9}, {3.889762624625411*^9, 
   3.889762681270576*^9}, {3.889762715057639*^9, 3.8897627447933073`*^9}, {
   3.889762777312941*^9, 3.8897627814803534`*^9}, {3.889766414822946*^9, 
   3.889766417922085*^9}, {3.889772062841913*^9, 3.889772066157476*^9}, {
   3.889772752650895*^9, 3.889772755441873*^9}, {3.889772819925879*^9, 
   3.88977285535785*^9}, {3.889772893723155*^9, 3.8897729876275177`*^9}, {
   3.889773041171514*^9, 3.8897730424905024`*^9}, {3.889773088154813*^9, 
   3.8897731508747*^9}, {3.889773206181242*^9, 3.889773213791629*^9}, {
   3.889773250163784*^9, 3.8897732575508757`*^9}, {3.8897733175738173`*^9, 
   3.889773318719199*^9}, {3.889776617829235*^9, 3.889776635500332*^9}, {
   3.889777015411689*^9, 3.8897772820874434`*^9}, {3.889779260297538*^9, 
   3.889779331748444*^9}, 3.8897794378902063`*^9, {3.8897794725116863`*^9, 
   3.889779472650785*^9}, 3.88977951787656*^9, {3.889779611340424*^9, 
   3.889779613522311*^9}, {3.889779863661998*^9, 3.8897798661736317`*^9}, {
   3.8897800911812572`*^9, 3.889780189309112*^9}, {3.8897802897413177`*^9, 
   3.889780291620406*^9}, {3.8897803260296*^9, 3.889780332244959*^9}, {
   3.889780453280159*^9, 3.889780470004467*^9}, {3.889780516388872*^9, 
   3.889780528493236*^9}, {3.889780567969303*^9, 3.889780650445343*^9}, {
   3.88978098504381*^9, 3.889781004125334*^9}, {3.8897811128786097`*^9, 
   3.889781116077032*^9}, {3.889781228734461*^9, 3.8897812621017847`*^9}, {
   3.88978131414293*^9, 3.889781418000053*^9}, {3.889781521799428*^9, 
   3.889781599622768*^9}, {3.8897817021010113`*^9, 3.889781787376637*^9}, {
   3.889781825599527*^9, 3.889781832496777*^9}, {3.889781953015916*^9, 
   3.889782016456809*^9}, {3.8897820636764727`*^9, 3.8897821056803007`*^9}, {
   3.889782174083735*^9, 3.8897822168339453`*^9}, {3.889783905271328*^9, 
   3.889783963320424*^9}, {3.8897843028341303`*^9, 3.8897843054194098`*^9}, {
   3.8897844489302683`*^9, 3.889784449895257*^9}, {3.889784484487093*^9, 
   3.889784500018187*^9}, {3.889784549800853*^9, 3.8897846454228888`*^9}, {
   3.889785235044437*^9, 3.889785268520422*^9}, {3.8897853856072903`*^9, 
   3.889785386119488*^9}, {3.889785622014104*^9, 3.8897856316404743`*^9}, {
   3.889785668459689*^9, 3.8897856696974783`*^9}, {3.889785835795596*^9, 
   3.8897858585878363`*^9}, {3.889785958107296*^9, 3.8897859642847557`*^9}, {
   3.889786018253763*^9, 3.8897861691866827`*^9}, {3.889786787194234*^9, 
   3.889786806592795*^9}, {3.88978686562932*^9, 3.88978709766844*^9}, {
   3.8897871295635853`*^9, 3.889787629638638*^9}, {3.889787666885805*^9, 
   3.889787670566902*^9}, {3.8897877124270163`*^9, 3.889787754457559*^9}, 
   3.889787858031267*^9, {3.8898047490905457`*^9, 3.8898048380836163`*^9}, {
   3.889804903551046*^9, 3.8898049972595377`*^9}, {3.8898462127776833`*^9, 
   3.889846281165992*^9}, {3.889846312008301*^9, 3.889846402656897*^9}, {
   3.8898464507351847`*^9, 3.889846474775344*^9}, {3.889846510056827*^9, 
   3.88984657725846*^9}, {3.889846839181901*^9, 3.889846842104014*^9}, {
   3.889846878462075*^9, 3.8898469008029537`*^9}, {3.889847209307665*^9, 
   3.8898473113425407`*^9}, {3.8898473788644953`*^9, 3.889847382078321*^9}, {
   3.8898474186367493`*^9, 3.8898474848649397`*^9}, {3.889847621002658*^9, 
   3.88984766113338*^9}, {3.889847760205037*^9, 3.88984776487488*^9}, {
   3.8898505978409843`*^9, 3.8898506839577913`*^9}, {3.889850835853224*^9, 
   3.8898508553526*^9}, {3.889851093220806*^9, 3.889851165513077*^9}, {
   3.8898512240656567`*^9, 3.8898512635809097`*^9}, {3.889851328596917*^9, 
   3.889851333803043*^9}, {3.889851374567973*^9, 3.889851484801971*^9}, 
   3.8898515246314917`*^9, {3.889851555587778*^9, 3.889851961271538*^9}, {
   3.889852057783416*^9, 3.88985229788111*^9}, {3.8898524508138323`*^9, 
   3.889852457519547*^9}, {3.88985340783288*^9, 3.88985343488546*^9}, {
   3.8898534736638193`*^9, 3.889853524622591*^9}, {3.889855188150217*^9, 
   3.889855214960218*^9}, {3.889855325150523*^9, 3.889855485960537*^9}, {
   3.889855537367642*^9, 3.889855550910801*^9}, {3.8898556209457397`*^9, 
   3.88985582717734*^9}, {3.88985639828365*^9, 3.889856410750579*^9}, {
   3.88985644644246*^9, 3.889856448033078*^9}, {3.889856583776855*^9, 
   3.889856651366206*^9}, {3.889856683174199*^9, 3.889856820524699*^9}, {
   3.889857209295889*^9, 3.889857284322756*^9}, {3.8898597119513693`*^9, 
   3.889859743979558*^9}, {3.889860530719655*^9, 3.8898605444704943`*^9}, {
   3.889861167626328*^9, 3.889861178238819*^9}, {3.889861396686117*^9, 
   3.889861424501346*^9}, {3.889861570079713*^9, 3.88986160037813*^9}, {
   3.889861635145377*^9, 3.889861909215561*^9}, {3.889861940485445*^9, 
   3.8898621845301933`*^9}, {3.8898623015981283`*^9, 3.889862431883645*^9}, 
   3.8898624714154577`*^9, {3.8898628301886063`*^9, 3.8898628601508408`*^9}, {
   3.8898629085160217`*^9, 3.889863069173912*^9}, 3.8898631806548862`*^9, {
   3.889863243254279*^9, 3.889863276770668*^9}, {3.889863423898974*^9, 
   3.889863430816802*^9}, {3.889863870729453*^9, 3.889863878630653*^9}, {
   3.8898639374547377`*^9, 3.88986404226683*^9}, {3.889864077854061*^9, 
   3.889864084399626*^9}, {3.889864118565084*^9, 3.889864129523225*^9}, {
   3.889864179868903*^9, 3.889864181840907*^9}, {3.8898642235711603`*^9, 
   3.88986425433317*^9}, {3.889864309044672*^9, 3.889864353531575*^9}, {
   3.889864404097542*^9, 3.889864415620718*^9}, {3.8898644768117228`*^9, 
   3.88986449039019*^9}, {3.889864554930902*^9, 3.889864558511963*^9}, {
   3.889864591918817*^9, 3.889864596152165*^9}, {3.8898646270452538`*^9, 
   3.889864631218885*^9}, {3.88986468022311*^9, 3.889864683470752*^9}, {
   3.889864814949684*^9, 3.889864878546095*^9}, {3.889864916176371*^9, 
   3.889864968591352*^9}, {3.889865027621584*^9, 3.889865067424721*^9}, {
   3.889865111221821*^9, 3.889865143114682*^9}, {3.889865283587933*^9, 
   3.8898653596491823`*^9}, {3.889865481812427*^9, 3.889865489870611*^9}, {
   3.889865575092742*^9, 3.889865785656732*^9}, {3.889866089732197*^9, 
   3.889866128421294*^9}, {3.8898661622781363`*^9, 3.889866171127967*^9}, {
   3.889866232726058*^9, 3.889866453050445*^9}, {3.889866490835162*^9, 
   3.889866494310944*^9}, {3.889866541062044*^9, 3.8898665762255697`*^9}, {
   3.889866614910679*^9, 3.8898666467494698`*^9}, {3.889866901631392*^9, 
   3.8898669636327267`*^9}, {3.889867001529936*^9, 3.889867071680311*^9}, {
   3.8898671311256*^9, 3.88986718906695*^9}, {3.889867226969658*^9, 
   3.8898672306360188`*^9}, {3.8898673190463247`*^9, 3.889867320346911*^9}, 
   3.889867440621801*^9, {3.889867475969542*^9, 3.889867477703538*^9}, 
   3.889867518616147*^9, {3.889874567088429*^9, 3.889874587252029*^9}, {
   3.889875284036978*^9, 3.889875301575877*^9}, {3.8898753545738163`*^9, 
   3.8898754704482813`*^9}, {3.889875516659457*^9, 3.889875540980504*^9}, {
   3.889875576645439*^9, 3.889875607181574*^9}, {3.889876029258095*^9, 
   3.8898760774486427`*^9}, {3.889876452602025*^9, 3.889876520746736*^9}, {
   3.88987763213295*^9, 3.889877692766238*^9}, 3.889878077494217*^9, {
   3.88987817231012*^9, 3.88987825200948*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"df246f81-4246-47c0-b8c7-cfbab1385dc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Debugging", "Subsection",
 CellChangeTimes->{{3.889874179290223*^9, 3.8898741922974052`*^9}, 
   3.889874233153438*^9},ExpressionUUID->"8c85b139-9e87-4170-b9e3-\
6a27a0b57522"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "generatecycwords", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generate", " ", "a", " ", "list", " ", "of", " ", "all", " ", 
    "nonequivalent", " ", 
    RowBox[{"(", 
     RowBox[{"and", " ", "nonzero"}], ")"}], " ", "cyclic", " ", "words", " ",
     "of", " ", "length", " ", "n"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generatecycwords", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gen", ",", 
        RowBox[{"res", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"gen", "[", 
         RowBox[{"i_", ",", "s_String"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gen", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"s", ",", "#"}], "]"}]}], "]"}], ")"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "symbols", "]"}]}], " ", "/;", " ", 
         RowBox[{"i", ">=", "1"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gen", "[", 
         RowBox[{"0", ",", "s_String"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"res", ",", 
           RowBox[{"cycsort", "[", "s", "]"}]}], "]"}], " ", "/;", " ", 
         RowBox[{"Not", "[", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"res", ",", 
            RowBox[{"cycsort", "[", "s", "]"}]}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gen", "[", 
        RowBox[{"n", ",", "\"\<\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"cyc", "/@", "res"}], ",", "0"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "jacobi", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Jacobi", " ", "identity"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jacobi", "[", 
    RowBox[{"a_String", ",", "b_String", ",", "c_String"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"bracket", "[", 
     RowBox[{"bracket", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], " ", "//", " ", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"jacobi", "[", 
     RowBox[{
      RowBox[{"cyc", "[", "a_", "]"}], ",", 
      RowBox[{"cyc", "[", "b_", "]"}], ",", 
      RowBox[{"cyc", "[", "c_", "]"}]}], "]"}], ":=", 
    RowBox[{"jacobi", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "testjacobi", "]"}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Returns", " ", "a", " ", "list", " ", "of", " ", "triples", " ", "of", 
     " ", "cyclic", " ", "words", " ", "of", " ", "length"}], " ", "<=", 
    RowBox[{
    "n", " ", "for", " ", "which", " ", "the", " ", "Jacobi", " ", "identity",
      " ", "does", " ", "NOT", " ", "hold"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testjacobi", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"generatecycwords", ",", 
           RowBox[{"Range", "[", "n", "]"}]}], "]"}], "]"}], ",", "3"}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"jacobi", ",", "#"}], "]"}], "=!=", "0"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "cojacobi", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cojacobi", "[", "a_String", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"cobracket", "[", 
     RowBox[{"cobracket", "[", "a", "]"}], "]"}], " ", "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cojacobi", "[", 
     RowBox[{"cyc", "[", "x_", "]"}], "]"}], ":=", 
    RowBox[{"cojacobi", "[", "x", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "testcojacobi", "]"}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Returns", " ", "a", " ", "list", " ", "of", " ", "cyclic", " ", "words", 
     " ", "of", " ", "length"}], " ", "<=", 
    RowBox[{
    "n", " ", "for", " ", "which", " ", "the", " ", "cojacobi", " ", 
     "identity", " ", "does", " ", "NOT", " ", "hold"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testcojacobi", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"generatecycwords", ",", 
         RowBox[{"Range", "[", "n", "]"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"cojacobi", "[", "#", "]"}], "=!=", "0"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "involutivity", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Involutivity", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"involutivity", "[", "a_String", "]"}], ":=", 
   RowBox[{
    RowBox[{"bracket", "[", 
     RowBox[{"cobracket", "[", "a", "]"}], "]"}], " ", "//", " ", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"involutivity", "[", 
     RowBox[{"cyc", "[", "x_", "]"}], "]"}], ":=", 
    RowBox[{"involutivity", "[", "x", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "testinvolutivity", "]"}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Returns", " ", "a", " ", "list", " ", "of", " ", "cyclic", " ", "words", 
     " ", "of", " ", "length"}], " ", "<=", 
    RowBox[{
    "n", " ", "for", " ", "which", " ", "the", " ", "involutivity", " ", 
     "does", " ", "NOT", " ", "hold"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testinvolutivity", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"generatecycwords", ",", 
         RowBox[{"Range", "[", "n", "]"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"involutivity", "[", "#", "]"}], "=!=", "0"}], "&"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "drinfeld", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Drinfeld", " ", "identity"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drinfeld", "[", 
    RowBox[{"a_String", ",", "b_String"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"cobracket", "[", 
      RowBox[{"bracket", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "]"}], "+", 
     RowBox[{"bracket", "[", 
      RowBox[{"cobracket", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"drinfeld", "[", 
     RowBox[{
      RowBox[{"cyc", "[", "x_", "]"}], ",", 
      RowBox[{"cyc", "[", "y_", "]"}]}], "]"}], ":=", 
    RowBox[{"drinfeld", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "testdrinfeld", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Returns", " ", "a", " ", "list", " ", "of", " ", "pairs", " ", "of", " ",
      "cyclic", " ", "words", " ", "of", " ", "length", " ", "n"}], "<=", 
    RowBox[{
    "2", " ", "for", " ", "which", " ", "the", " ", "Drinfeld", " ", 
     "identity", " ", "does", " ", "not", " ", "hold"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testdrinfeld", "[", "n_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"generatecycwords", ",", 
          RowBox[{"Range", "[", "n", "]"}]}], "]"}], "]"}], ",", "2"}], "]"}],
      ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"drinfeld", ",", "#"}], "]"}], "=!=", "0"}], "&"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.889874221316132*^9, 3.889874231366235*^9}, {
  3.889877785178276*^9, 3.8898777857812443`*^9}},
 CellLabel->
  "In[3772]:=",ExpressionUUID->"48aaedc8-f4fe-4e45-af7e-5c234bfbc68b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Run", " ", "the", " ", "tests"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"testjacobi", "[", "4", "]"}], ",", 
    RowBox[{"testcojacobi", "[", "10", "]"}], ",", 
    RowBox[{"testdrinfeld", "[", "5", "]"}], ",", 
    RowBox[{"testinvolutivity", "[", "10", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8898742413578243`*^9, 3.889874272844468*^9}, {
  3.8898777633433523`*^9, 3.8898777790126877`*^9}},
 CellLabel->
  "In[3794]:=",ExpressionUUID->"b344e60d-b1e4-4a6c-a71c-a19abde4f4ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.889878147688757*^9, {3.889878489211008*^9, 3.889878497455338*^9}, 
   3.889878543997834*^9},
 CellLabel->
  "Out[3794]=",ExpressionUUID->"66386971-0f00-4db0-859b-b2cddf0de813"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 810},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.8 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5f7ec20e-1049-43f8-8993-69fe7804cbb6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 374, 5, 79, "Title",ExpressionUUID->"4f4b5762-d0ee-4715-b8bc-9999fcd0012f"],
Cell[957, 29, 285, 4, 46, "Subtitle",ExpressionUUID->"50c7375b-ac0d-4863-a345-07b74c710ace"],
Cell[CellGroupData[{
Cell[1267, 37, 162, 3, 43, "Subsection",ExpressionUUID->"62160cb7-878d-46f0-b665-a438b109e2a8"],
Cell[1432, 42, 1739, 27, 120, "Text",ExpressionUUID->"7842283f-24a7-4916-bad2-47563444102f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3208, 74, 155, 3, 43, "Subsection",ExpressionUUID->"3c4844a6-7d97-479c-bf7d-ba25d57e53d0"],
Cell[3366, 79, 1009, 16, 25, "ItemNumbered",ExpressionUUID->"0cd8b9ae-a863-4daa-a7fc-62951c9f33f2"],
Cell[4378, 97, 886, 13, 25, "ItemNumbered",ExpressionUUID->"024b716a-e0b8-4578-817c-46016f97520d"],
Cell[5267, 112, 865, 14, 25, "ItemNumbered",ExpressionUUID->"68ee11fc-395b-4077-b6e4-153db6c82a31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6169, 131, 205, 4, 43, "Subsection",ExpressionUUID->"ddb3e609-40e6-4be5-a264-7677171e533d"],
Cell[6377, 137, 23521, 344, 105, "Input",ExpressionUUID->"2308ceb8-2234-4955-aabe-2d51ddd6ec04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29935, 486, 206, 4, 43, "Subsection",ExpressionUUID->"8e7d33c9-497f-4572-87bf-aaa23d71cdcf"],
Cell[CellGroupData[{
Cell[30166, 494, 467, 10, 23, "Input",ExpressionUUID->"46cd41a6-4d77-46b9-87a9-2927980163b2"],
Cell[30636, 506, 298, 9, 26, "Output",ExpressionUUID->"e439446b-f2a4-4d9d-baf9-13971a414b2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30971, 520, 388, 8, 23, "Input",ExpressionUUID->"d947cf07-7cf8-404f-afc5-03d1a93928bd"],
Cell[31362, 530, 409, 11, 26, "Output",ExpressionUUID->"7292b4c8-7974-4fd6-bea9-5761bf3055f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31808, 546, 578, 12, 23, "Input",ExpressionUUID->"b8224d52-cd97-41ec-afc4-7e3fca002af9"],
Cell[32389, 560, 933, 27, 26, "Output",ExpressionUUID->"63d7503e-0d19-4dd8-93e1-e26397e6a4e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33359, 592, 479, 12, 23, "Input",ExpressionUUID->"f41318c3-ccb8-4552-8d27-9b5a590ee78c"],
Cell[33841, 606, 935, 25, 26, "Output",ExpressionUUID->"03237bad-dfde-4685-bcc3-34f45a9326f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34813, 636, 756, 16, 23, "Input",ExpressionUUID->"1f34151f-a10a-47f2-970d-7189af4f3254"],
Cell[35572, 654, 719, 20, 26, "Output",ExpressionUUID->"e58ea005-f95f-420c-8d46-9430f0dfd52b"]
}, Open  ]],
Cell[36306, 677, 419, 8, 25, "Item",ExpressionUUID->"059f5541-f666-4d59-a339-103df872b099"],
Cell[36728, 687, 771, 14, 25, "Item",ExpressionUUID->"63fcd4bf-171a-4b26-87b2-54563be010a6"],
Cell[37502, 703, 692, 14, 25, "Item",ExpressionUUID->"f116a4a5-bc3b-44de-b88f-e24bd967e472"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38231, 722, 167, 3, 43, "Subsection",ExpressionUUID->"c68e33f2-7907-45c5-8556-f07604b7a9f1"],
Cell[38401, 727, 70279, 1466, 2875, "Input",ExpressionUUID->"df246f81-4246-47c0-b8c7-cfbab1385dc6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[108717, 2198, 182, 3, 43, "Subsection",ExpressionUUID->"8c85b139-9e87-4170-b9e3-6a27a0b57522"],
Cell[108902, 2203, 9205, 264, 760, "Input",ExpressionUUID->"48aaedc8-f4fe-4e45-af7e-5c234bfbc68b"],
Cell[CellGroupData[{
Cell[118132, 2471, 587, 14, 41, "Input",ExpressionUUID->"b344e60d-b1e4-4a6c-a71c-a19abde4f4ca"],
Cell[118722, 2487, 370, 11, 26, "Output",ExpressionUUID->"66386971-0f00-4db0-859b-b2cddf0de813"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

